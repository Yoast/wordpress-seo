YoastSEO="undefined"==typeof YoastSEO?{}:YoastSEO,function(a){"use strict";var b,c=5,d=function(){};d.prototype.initDOM=function(){b=wp.template("keyword_tab"),this.setTextInput(),this.insertElements(),this.bindKeywordField(),this.bindKeywordAdd(),this.bindScore(),this.bindKeywordTab(),this.bindKeywordRemove(),this.updateInactiveKeywords()},d.prototype.setTextInput=function(){a("#yoast_wpseo_focuskw_text_input").val(a("#yoast_wpseo_focuskw").val())},d.prototype.updateKeywords=function(b){var c,d;this.updateActiveKeywordTab(b),this.updateInactiveKeywords(),this.updateOverallScore(),d=a(".wpseo_keyword_tab").map(function(b,c){return c=a(c).find(".wpseo_tablink"),{keyword:c.data("keyword")+"",score:c.data("score")}}).get(),d=_.filter(d,function(a){return a.keyword.length>0}),0===d.length&&d.push({keyword:"",score:0}),d.length>0&&(c=d.splice(0,1).shift(),a("#yoast_wpseo_focuskw").val(c.keyword)),a("#yoast_wpseo_focuskeywords").val(JSON.stringify(d))},d.prototype.insertElements=function(){this.addKeywordTabs()},d.prototype.bindScore=function(){a(window).on("YoastSEO:numericScore",this.handleUpdatedScore.bind(this))},d.prototype.handleUpdatedScore=function(a,b){this.updateKeywords(b)},d.prototype.bindKeywordTab=function(){a(".wpseo-metabox-tabs").on("click",".wpseo_keyword_tab > .wpseo_tablink",function(){var b=a(this).data("keyword")+"";a("#yoast_wpseo_focuskw_text_input").val(b).focus(),YoastSEO.app.refresh()})},d.prototype.bindKeywordRemove=function(){a(".wpseo-metabox-tabs").on("click",".remove-keyword",function(b){var c,d;b.preventDefault(),d=a(b.currentTarget).parent("li"),c=d.prev(),d.remove(),d.hasClass("active")&&c.find(".wpseo_tablink").click(),this.updateUI()}.bind(this))},d.prototype.bindKeywordField=function(){a("#yoast_wpseo_focuskw_text_input").on("input",function(b){var c,d;d=a(b.currentTarget).val(),c=a("li.active > .wpseo_tablink"),c.data("keyword",d),c.find("span.wpseo_keyword").text(d||"...")}.bind(this))},d.prototype.bindKeywordAdd=function(){a(".wpseo-add-keyword").click(function(){this.canAddTab()&&this.addKeywordTab(null,"na",!0)}.bind(this))},d.prototype.addKeywordTabs=function(){var b=JSON.parse(a("#yoast_wpseo_focuskeywords").val()||"[]");if(b.unshift({keyword:a("#yoast_wpseo_focuskw").val(),score:a("#yoast_wpseo_linkdex").val()}),a("#wpseo-metabox-tabs").find(".wpseo_keyword_tab").remove(),b.length>0)for(var c in b){var d=b[c].keyword,e=b[c].score;this.addKeywordTab(d,e)}a(".wpseo_keyword_tab").first().addClass("active")},d.prototype.addKeywordTab=function(c,d,e){var f,g,h;c=c||"",f=c.length>0?c:"...",h={keyword:c,placeholder:f,score:d},0===a(".wpseo_keyword_tab").length&&(h.prefix=wpseoPostScraperL10n.contentTab,h.hideRemove=!0),g=b(h),a(".wpseo-tab-add-keyword").before(g),this.updateUI(),e===!0&&a(".wpseo_keyword_tab:last > .wpseo_tablink").click()},d.prototype.updateUI=function(){var b=a(".wpseo-add-keyword");this.canAddTab()?b.prop("disabled",!1).attr("aria-disabled","false"):b.prop("disabled",!0).attr("aria-disabled","true")},d.prototype.updateActiveKeywordTab=function(b){var c,d;d=a(".wpseo_keyword_tab.active"),c=a("#yoast_wpseo_focuskw_text_input").val(),this.renderKeywordTab(c,b,d,!0)},d.prototype.updateInactiveKeywords=_.debounce(function(){var b;b=a(".wpseo_keyword_tab:not( .active )"),b.each(function(a,b){this.updateKeywordTab(b)}.bind(this))},300),d.prototype.updateKeywordTab=function(b){var c,d,e;b=a(b),d=b.find(".wpseo_tablink"),c=d.data("keyword")+"",e=this.analyzeKeyword(c),this.renderKeywordTab(c,e,b)},d.prototype.renderKeywordTab=function(c,d,e,f){var g,h,i;e=a(e),i=c.length>0?c:"...",""===c?d="na":(d=parseInt(d,10),d=YoastSEO.ScoreFormatter.prototype.overallScoreRating(d)),h={keyword:c,placeholder:i,score:d},0===e.index()&&(h.hideRemove=!0,h.prefix=wpseoPostScraperL10n.contentTab),!0===f&&(h.active=!0),g=b(h),!0===f&&(g=g.replace('class="wpseo_keyword_tab','class="wpseo_keyword_tab active')),e.replaceWith(g)},d.prototype.analyzeKeyword=function(a){var b,c;return YoastSEO.app.getData(),b=YoastSEO.app.rawData,b=YoastSEO.app.modifyData(b),b.i18n=YoastSEO.app.i18n,a=YoastSEO.app.stringHelper.sanitizeKeyword(a),b.keyword=a,""===a&&(b.queue=["keyWordCheck","wordCount","fleschReading","pageTitleLength","urlStopwords","metaDescriptionLength"]),c=new YoastSEO.Analyzer(b),YoastSEO.app.pluggable._addPluginTests(c),c.runQueue(),c.score(),c.analyzeScorer.getTotalScore()},d.prototype.updateOverallScore=function(){var b,c,d;c=a("#yoast_wpseo_focuskw"),d=a("#yoast_wpseo_focuskw_text_input"),c.val()!==d.val()&&(b=a("#yoast_wpseo_linkdex").val(),b=parseInt(b,10),b=YoastSEO.app.scoreFormatter.overallScoreRating(b),""===c.val()&&(b="na"),a(".overallScore").removeClass("na bad ok good").addClass(b))},d.prototype.canAddTab=function(){var b;return b=a(".wpseo_keyword_tab").length,c>b};var e=new d;a(window).on("YoastSEO:ready",e.initDOM.bind(e)),YoastSEO.multiKeyword=!0}(jQuery);