YoastSEO="undefined"==typeof YoastSEO?{}:YoastSEO,function(a){"use strict";var b,c=5,d=function(){this.insertElements(),this.bindKeywordField(),this.bindKeywordAdd(),this.bindScore(),this.bindKeywordTab(),this.bindKeywordRemove()};d.prototype.updateKeywords=function(b){var c;this.updateActiveKeywordTab(b),this.updateInactiveKeywords(),c=a(".wpseo_keyword_tab").map(function(b,c){return c=a(c).find(".wpseo_tablink"),{keyword:c.data("keyword"),score:c.data("score")}}).get(),c=_.filter(c,function(a){return a.keyword.length>0}),a("#yoast_wpseo_focuskeywords").val(JSON.stringify(c))},d.prototype.insertElements=function(){this.addKeywordTabs()},d.prototype.bindScore=function(){a(window).on("YoastSEO:numericScore",this.handleUpdatedScore.bind(this))},d.prototype.handleUpdatedScore=function(a,b){this.updateKeywords(b)},d.prototype.bindKeywordTab=function(){a(".wpseo-metabox-tabs").on("click",".wpseo_tablink",function(){var b=a(this).data("keyword");a("#yoast_wpseo_focuskw").val(b).focus(),YoastSEO.app.refresh()})},d.prototype.bindKeywordRemove=function(){a(".wpseo-metabox-tabs").on("click",".remove-keyword",function(b){b.preventDefault();var c=a(b.currentTarget).parent("li"),d=c.prev();c.remove(),c.hasClass("active")&&d.find(".wpseo_tablink").click(),this.updateKeywords(),this.updateUI()}.bind(this))},d.prototype.bindKeywordField=function(){a("#yoast_wpseo_focuskw").on("input",function(b){var c=a(b.currentTarget).val(),d=a("li.active > .wpseo_tablink");d.data("keyword",c),d.find("span.wpseo_keyword").text(c||"..."),this.updateKeywords()}.bind(this))},d.prototype.bindKeywordAdd=function(){a(".wpseo-add-keyword").click(function(){this.canAddTab()&&this.addKeywordTab(null,"na",!0)}.bind(this))},d.prototype.addKeywordTabs=function(){var b=JSON.parse(a("#yoast_wpseo_focuskeywords").val()||"[]");if(a("#wpseo-metabox-tabs").find(".wpseo_keyword_tab").remove(),b.length>0)for(var c in b){var d=b[c].keyword,e=b[c].score;this.addKeywordTab(d,e)}a(".wpseo_keyword_tab").first().addClass("active")},d.prototype.addKeywordTab=function(c,d,e){c=c||"";var f=c.length>0?c:"...",g=b({keyword:c,placeholder:f,score:d});a(".wpseo-tab-add-keyword").before(g),this.updateUI(),e===!0&&a(".wpseo_keyword_tab:last > .wpseo_tablink").click()},d.prototype.updateUI=function(){var b=a(".wpseo-add-keyword");this.canAddTab()?b.prop("disabled",!1).attr("aria-disabled","false"):b.prop("disabled",!0).attr("aria-disabled","true")},d.prototype.updateActiveKeywordTab=function(b){var c,d;d=a(".wpseo_keyword_tab.active"),c=a("#yoast_wpseo_focuskw").val(),this.renderKeywordTab(c,b,d,!0)},d.prototype.updateInactiveKeywords=_.debounce(function(){var b;b=a(".wpseo_keyword_tab:not( .active )"),b.each(function(a,b){this.updateKeywordTab(b)}.bind(this))},300),d.prototype.updateKeywordTab=function(b){var c,d,e;b=a(b),d=b.find(".wpseo_tablink"),c=d.data("keyword"),e=this.analyzeKeyword(c),this.renderKeywordTab(c,e,b)},d.prototype.renderKeywordTab=function(c,d,e,f){var g,h,i;e=a(e),i=c.length>0?c:"...",d=parseInt(d,10),d=YoastSEO.ScoreFormatter.prototype.scoreRating(d),h={keyword:c,placeholder:i,score:d},0===e.index()&&(h.hideRemove=!0,h.prefix=wpseoPostScraperL10n.contentTab),!0===f&&(h.active=!0),g=b(h),!0===f&&(g=g.replace('class="wpseo_keyword_tab','class="wpseo_keyword_tab active')),e.replaceWith(g)},d.prototype.analyzeKeyword=function(a){var b,c;return b=YoastSEO.app.config.callbacks.getData(),b.i18n=YoastSEO.app.i18n,b.keyword=a,c=new YoastSEO.Analyzer(b),c.runQueue(),c.score(),c.analyzeScorer.getTotalScore()},d.prototype.canAddTab=function(){var b;return b=a(".wpseo_keyword_tab").length,c>b},a(window).on("YoastSEO:ready",function(){b=wp.template("keyword_tab");var a=new d;a.updateInactiveKeywords()}),YoastSEO.multiKeyword=!0}(jQuery);