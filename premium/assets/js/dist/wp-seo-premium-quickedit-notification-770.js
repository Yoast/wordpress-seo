(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";

/* global ajaxurl */
/* jshint -W097 */

var redirectFunctions = require("./redirects/functions");

/**
 * Use notification counter so we can count how many times the function wpseoShowNotification is called.
 *
 * @type {number}
 */
var wpseoNotificationCounter = 0;

/**
 * Show notification to user when there's a redirect created. When the response is empty, up the notification counter
 * with 1, wait 100 ms and call function again.
 * Stop when the notification counter is bigger than 20.
 *
 * @returns {void}
 */
function wpseoShowNotification() {
	jQuery.post(ajaxurl, { action: "yoast_get_notifications" }, function (response) {
		if (response !== "") {
			var insertAfterElement = jQuery(".wrap").children().eq(0);
			jQuery(response).insertAfter(insertAfterElement);
			wpseoNotificationCounter = 0;
		}

		if (wpseoNotificationCounter < 20 && response === "") {
			wpseoNotificationCounter++;
			setTimeout(wpseoShowNotification, 500);
		}
	});
}

window.wpseoShowNotification = wpseoShowNotification;

/**
 * Gets the current page based on the current URL.
 *
 * @returns {string} The current page.
 */
function wpseoGetCurrentPage() {
	return jQuery(location).attr("pathname").split("/").pop();
}

window.wpseoGetCurrentPage = wpseoGetCurrentPage;

/**
 * Gets the name of the field to get the slug from, based on the current URL.
 *
 * For posts, this is 'post_name', for terms it is 'slug'.
 *
 * @returns {string} The current slug field name.
 */
function wpseoGetSlugField(currentPage) {
	currentPage = currentPage || wpseoGetCurrentPage();

	if (currentPage === "edit-tags.php") {
		return "slug";
	}

	return "post_name";
}

/**
 * Gets the current slug of a post based on the current page and post or term being edited.
 *
 * @returns {string} The slug of the current post or term.
 */
function wpseoGetCurrentSlug() {
	var currentPost = wpseoGetItemId();
	var slugField = wpseoGetSlugField();

	return jQuery("#inline_" + currentPost).find("." + slugField).html();
}

window.wpseoGetCurrentSlug = wpseoGetCurrentSlug;

/**
 * Checks whether or not the slug has changed.
 *
 * @returns {boolean} Whether or not the slug has changed.
 */
function wpseoSlugChanged() {
	var editor = wpseoGetActiveEditor();
	var slugField = wpseoGetSlugField();
	var currentSlug = wpseoGetCurrentSlug();
	var newSlug = editor.find("input[name=" + slugField + "]").val();

	return currentSlug !== newSlug;
}

window.wpseoSlugChanged = wpseoSlugChanged;

/**
 * Gets the currently active editor used in quick edit.
 *
 * @returns {Object} The editor that is currently active.
 */
function wpseoGetActiveEditor() {
	return jQuery("tr.inline-editor");
}

window.wpseoGetActiveEditor = wpseoGetActiveEditor;

/**
 * Gets the current post or term id.
 * Returns an empty string if no editor is currently active.
 *
 * @returns {string} The ID of the current post or term.
 */
function wpseoGetItemId() {
	var editor = wpseoGetActiveEditor();

	if (editor.length === 0 || editor === "") {
		return "";
	}

	return editor.attr("id").replace("edit-", "");
}

window.wpseoGetItemId = wpseoGetItemId;

/**
 * Handles the key-based events in the quick edit editor.
 *
 * @param {Event} ev The event currently being executed.
 *
 * @returns {void}
 */
function wpseoHandleKeyEvents(ev) {
	// 13 refers to the enter key.
	if (ev.which === 13 && wpseoSlugChanged()) {
		wpseoShowNotification();
	}
}

window.wpseoHandleKeyEvents = wpseoHandleKeyEvents;

/**
 * Handles the button-based events in the quick edit editor.
 *
 * @param {Event} ev The event currently being executed.
 *
 * @returns {void}
 */
function wpseoHandleButtonEvents(ev) {
	if (jQuery(ev.target).attr("id") !== "save-order" && wpseoSlugChanged()) {
		wpseoShowNotification();
	}
}

window.wpseoHandleButtonEvents = wpseoHandleButtonEvents;

window.wpseoUndoRedirect = redirectFunctions.wpseoUndoRedirect;
window.wpseoCreateRedirect = redirectFunctions.wpseoCreateRedirect;

jQuery(function () {
	var wpseoCurrentPage = wpseoGetCurrentPage();

	switch (wpseoCurrentPage) {

		// Terms list screen.
		case "edit-tags.php":
			jQuery(document).on("ajaxComplete", function (e, xhr, settings) {
				if (settings.data.indexOf("action=delete-tag") > -1) {
					wpseoShowNotification();
				}
			});

		// Posts list screen.
		case "edit.php":
			jQuery("#inline-edit input").on("keydown", function (ev) {
				wpseoHandleKeyEvents(ev);
			});

			jQuery(".button-primary").click(function (ev) {
				wpseoHandleButtonEvents(ev);
			});

			break;
	}
});

},{"./redirects/functions":2}],2:[function(require,module,exports){
"use strict";

/* global wpseoPremiumStrings, ajaxurl */

/**
 * Undoes a redirect.
 *
 * @param {string} origin The redirect's origin.
 * @param {string} target The redirect's target.
 * @param {string} type The type of redirect.
 * @param {string} nonce The nonce being used to validate the current AJAX request.
 * @param {object} source The DOMElement containing the alerts.
 *
 * @returns {void}
 */
function wpseoUndoRedirect(origin, target, type, nonce, source) {
	jQuery.post(ajaxurl, {
		action: "wpseo_delete_redirect_plain",
		ajax_nonce: nonce,
		redirect: {
			origin: origin,
			target: target,
			type: type
		}
	}, function () {
		jQuery(source).closest(".yoast-alert").fadeOut("slow");
	});
}

/**
 * Creates a redirect
 *
 * @param {string} origin The origin.
 * @param {string} type   The redirect type, regex or plain.
 * @param {string} nonce  The nonce.
 * @param {object} source The source of the redirect.
 *
 * @returns {void}
 */
function wpseoCreateRedirect(origin, type, nonce, source) {
	var target = "";

	if (parseInt(type, 10) !== 410) {
		/* eslint-disable no-alert */
		target = window.prompt(wpseoPremiumStrings.enter_new_url.replace("%s", origin));
		/* eslint-enable no-alert */

		if (target === "") {
			/* eslint-disable no-alert */
			window.alert(wpseoPremiumStrings.error_new_url);
			/* eslint-enable no-alert */
			return;
		}
	}

	jQuery.post(ajaxurl, {
		action: "wpseo_add_redirect_plain",
		ajax_nonce: nonce,
		redirect: {
			origin: origin,
			target: target,
			type: type
		}
	}, function (response) {
		var notice = jQuery(source).closest(".yoast-alert");
		// Remove the classes first.
		jQuery(notice).removeClass("updated").removeClass("error");

		// Remove possibly added redirect errors.
		jQuery(notice).find(".redirect_error").remove();

		if (response.error) {
			// Add paragraph on top of the notice with actions and set class to error.
			jQuery(notice).addClass("error").prepend("<p class=\"redirect_error\">" + response.error.message + "</p>");

			return;
		}

		// Parse the success message.
		var successMessage = "";
		if (parseInt(type, 10) === 410) {
			successMessage = wpseoPremiumStrings.redirect_saved_no_target;
		} else {
			successMessage = wpseoPremiumStrings.redirect_saved.replace("%2$s", "<code>" + response.target + "</code>");
		}

		successMessage = successMessage.replace("%1$s", "<code>" + response.origin + "</code>");

		// Set class to updated and replace html with the success message.
		jQuery(notice).addClass("updated").html("<p>" + successMessage + "</p>");
	}, "json");
}

module.exports = {
	wpseoCreateRedirect: wpseoCreateRedirect,
	wpseoUndoRedirect: wpseoUndoRedirect
};

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhc3NldHMvanMvc3JjL3F1aWNrZWRpdC1ub3RpZmljYXRpb24uanMiLCJhc3NldHMvanMvc3JjL3JlZGlyZWN0cy9mdW5jdGlvbnMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBO0FBQ0E7O0FBRUEsSUFBSSxvQkFBb0IsUUFBUyx1QkFBVCxDQUF4Qjs7QUFFQTs7Ozs7QUFLQSxJQUFJLDJCQUEyQixDQUEvQjs7QUFFQTs7Ozs7OztBQU9BLFNBQVMscUJBQVQsR0FBaUM7QUFDaEMsUUFBTyxJQUFQLENBQ0MsT0FERCxFQUVDLEVBQUUsUUFBUSx5QkFBVixFQUZELEVBR0MsVUFBVSxRQUFWLEVBQXFCO0FBQ3BCLE1BQUssYUFBYSxFQUFsQixFQUF1QjtBQUN0QixPQUFJLHFCQUFxQixPQUFRLE9BQVIsRUFBa0IsUUFBbEIsR0FBNkIsRUFBN0IsQ0FBaUMsQ0FBakMsQ0FBekI7QUFDQSxVQUFRLFFBQVIsRUFBbUIsV0FBbkIsQ0FBZ0Msa0JBQWhDO0FBQ0EsOEJBQTJCLENBQTNCO0FBQ0E7O0FBRUQsTUFBSywyQkFBMkIsRUFBM0IsSUFBaUMsYUFBYSxFQUFuRCxFQUF3RDtBQUN2RDtBQUNBLGNBQVkscUJBQVosRUFBbUMsR0FBbkM7QUFDQTtBQUNELEVBZEY7QUFnQkE7O0FBRUQsT0FBTyxxQkFBUCxHQUErQixxQkFBL0I7O0FBRUE7Ozs7O0FBS0EsU0FBUyxtQkFBVCxHQUErQjtBQUM5QixRQUFPLE9BQVEsUUFBUixFQUFtQixJQUFuQixDQUF5QixVQUF6QixFQUFzQyxLQUF0QyxDQUE2QyxHQUE3QyxFQUFtRCxHQUFuRCxFQUFQO0FBQ0E7O0FBRUQsT0FBTyxtQkFBUCxHQUE2QixtQkFBN0I7O0FBRUE7Ozs7Ozs7QUFPQSxTQUFTLGlCQUFULENBQTRCLFdBQTVCLEVBQTBDO0FBQ3pDLGVBQWMsZUFBZSxxQkFBN0I7O0FBRUEsS0FBSyxnQkFBZ0IsZUFBckIs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WSxPQURaLEVBRUUsT0FGRixDQUVXLGlDQUFpQyxTQUFTLEtBQVQsQ0FBZSxPQUFoRCxHQUEwRCxNQUZyRTs7QUFJQTtBQUNBOztBQUVEO0FBQ0EsTUFBSSxpQkFBaUIsRUFBckI7QUFDQSxNQUFJLFNBQVUsSUFBVixFQUFnQixFQUFoQixNQUF5QixHQUE3QixFQUFtQztBQUNsQyxvQkFBaUIsb0JBQW9CLHdCQUFyQztBQUNBLEdBRkQsTUFFTztBQUNOLG9CQUFpQixvQkFBb0IsY0FBcEIsQ0FBbUMsT0FBbkMsQ0FBNEMsTUFBNUMsRUFBb0QsV0FBVyxTQUFTLE1BQXBCLEdBQTZCLFNBQWpGLENBQWpCO0FBQ0E7O0FBRUQsbUJBQWlCLGVBQWUsT0FBZixDQUF3QixNQUF4QixFQUFnQyxXQUFXLFNBQVMsTUFBcEIsR0FBNkIsU0FBN0QsQ0FBakI7O0FBRUE7QUFDQSxTQUFRLE1BQVIsRUFDRSxRQURGLENBQ1ksU0FEWixFQUVFLElBRkYsQ0FFUSxRQUFRLGNBQVIsR0FBeUIsTUFGakM7QUFHQSxFQTVDRixFQTZDQyxNQTdDRDtBQStDQTs7QUFFRCxPQUFPLE9BQVAsR0FBaUI7QUFDaEIsc0JBQXFCLG1CQURMO0FBRWhCLG9CQUFtQjtBQUZILENBQWpCIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8qIGdsb2JhbCBhamF4dXJsICovXG4vKiBqc2hpbnQgLVcwOTcgKi9cblxudmFyIHJlZGlyZWN0RnVuY3Rpb25zID0gcmVxdWlyZSggXCIuL3JlZGlyZWN0cy9mdW5jdGlvbnNcIiApO1xuXG4vKipcbiAqIFVzZSBub3RpZmljYXRpb24gY291bnRlciBzbyB3ZSBjYW4gY291bnQgaG93IG1hbnkgdGltZXMgdGhlIGZ1bmN0aW9uIHdwc2VvU2hvd05vdGlmaWNhdGlvbiBpcyBjYWxsZWQuXG4gKlxuICogQHR5cGUge251bWJlcn1cbiAqL1xudmFyIHdwc2VvTm90aWZpY2F0aW9uQ291bnRlciA9IDA7XG5cbi8qKlxuICogU2hvdyBub3RpZmljYXRpb24gdG8gdXNlciB3aGVuIHRoZXJlJ3MgYSByZWRpcmVjdCBjcmVhdGVkLiBXaGVuIHRoZSByZXNwb25zZSBpcyBlbXB0eSwgdXAgdGhlIG5vdGlmaWNhdGlvbiBjb3VudGVyXG4gKiB3aXRoIDEsIHdhaXQgMTAwIG1zIGFuZCBjYWxsIGZ1bmN0aW9uIGFnYWluLlxuICogU3RvcCB3aGVuIHRoZSBub3RpZmljYXRpb24gY291bnRlciBpcyBiaWdnZXIgdGhhbiAyMC5cbiAqXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqL1xuZnVuY3Rpb24gd3BzZW9TaG93Tm90aWZpY2F0aW9uKCkge1xuXHRqUXVlcnkucG9zdChcblx0XHRhamF4dXJsLFxuXHRcdHsgYWN0aW9uOiBcInlvYXN0X2dldF9ub3RpZmljYXRpb25zXCIgfSxcblx0XHRmdW5jdGlvbiggcmVzcG9uc2UgKSB7XG5cdFx0XHRpZiAoIHJlc3BvbnNlICE9PSBcIlwiICkge1xuXHRcdFx0XHR2YXIgaW5zZXJ0QWZ0ZXJFbGVtZW50ID0galF1ZXJ5KCBcIi53cmFwXCIgKS5jaGlsZHJlbigpLmVxKCAwICk7XG5cdFx0XHRcdGpRdWVyeSggcmVzcG9uc2UgKS5pbnNlcnRBZnRlciggaW5zZXJ0QWZ0ZXJFbGVtZW50ICk7XG5cdFx0XHRcdHdwc2VvTm90aWZpY2F0aW9uQ291bnRlciA9IDA7XG5cdFx0XHR9XG5cblx0XHRcdGlmICggd3BzZW9Ob3RpZmljYXRpb25Db3VudGVyIDwgMjAgJiYgcmVzcG9uc2UgPT09IFwiXCIgKSB7XG5cdFx0XHRcdHdwc2VvTm90aWZpY2F0aW9uQ291bnRlcisrO1xuXHRcdFx0XHRzZXRUaW1lb3V0KCB3cHNlb1Nob3dOb3RpZmljYXRpb24sIDUwMCApO1xuXHRcdFx0fVxuXHRcdH1cblx0KTtcbn1cblxud2luZG93Lndwc2VvU2hvd05vdGlmaWNhdGlvbiA9IHdwc2VvU2hvd05vdGlmaWNhdGlvbjtcblxuLyoqXG4gKiBHZXRzIHRoZSBjdXJyZW50IHBhZ2UgYmFzZWQgb24gdGhlIGN1cnJlbnQgVVJMLlxuICpcbiAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBjdXJyZW50IHBhZ2UuXG4gKi9cbmZ1bmN0aW9uIHdwc2VvR2V0Q3VycmVudFBhZ2UoKSB7XG5cdHJldHVybiBqUXVlcnkoIGxvY2F0aW9uICkuYXR0ciggXCJwYXRobmFtZVwiICkuc3BsaXQoIFwiL1wiICkucG9wKCk7XG59XG5cbndpbmRvdy53cHNlb0dldEN1cnJlbnRQYWdlID0gd3BzZW9HZXRDdXJyZW50UGFnZTtcblxuLyoqXG4gKiBHZXRzIHRoZSBuYW1lIG9mIHRoZSBmaWVsZCB0byBnZXQgdGhlIHNsdWcgZnJvbSwgYmFzZWQgb24gdGhlIGN1cnJlbnQgVVJMLlxuICpcbiAqIEZvciBwb3N0cywgdGhpcyBpcyAncG9zdF9uYW1lJywgZm9yIHRlcm1zIGl0IGlzICdzbHVnJy5cbiAqXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgY3VycmVudCBzbHVnIGZpZWxkIG5hbWUuXG4gKi9cbmZ1bmN0aW9uIHdwc2VvR2V0U2x1Z0ZpZWxkKCBjdXJyZW50UGFnZSApIHtcblx0Y3VycmVudFBhZ2UgPSBjdXJyZW50UGFnZSB8fCB3cHNlb0dldEN1cnJlbnRQYWdlKCk7XG5cblx0aWYgKCBjdXJyZW50UGFnZSA9PT0gXCJlZGl0LXRhZ3MucGhwXCIgKSB7XG5cdFx0cmV0dXJuIFwic2x1Z1wiO1xuXHR9XG5cblx0cmV0dXJuIFwicG9zdF9uYW1lXCI7XG59XG5cbi8qKlxuICogR2V0cyB0aGUgY3VycmVudCBzbHVnIG9mIGEgcG9zdCBiYXNlZCBvbiB0aGUgY3VycmVudCBwYWdlIGFuZCBwb3N0IG9yIHRlcm0gYmVpbmcgZWRpdGVkLlxuICpcbiAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBzbHVnIG9mIHRoZSBjdXJyZW50IHBvc3Qgb3IgdGVybS5cbiAqL1xuZnVuY3Rpb24gd3BzZW9HZXRDdXJyZW50U2x1ZygpIHtcblx0dmFyIGN1cnJlbnRQb3N0ID0gd3BzZW9HZXRJdGVtSWQoKTtcblx0dmFyIHNsdWdGaWVsZCAgID0gd3BzZW9HZXRTbHVnRmllbGQoKTtcblxuXHRyZXR1cm4galF1ZXJ5KCBcIiNpbmxpbmVfXCIgKyBjdXJyZW50UG9zdCApLmZpbmQoIFwiLlwiICsgc2x1Z0ZpZWxkICkuaHRtbCgpO1xufVxuXG53aW5kb3cud3BzZW9HZXRDdXJyZW50U2x1ZyA9IHdwc2VvR2V0Q3VycmVudFNsdWc7XG5cbi8qKlxuICogQ2hlY2tzIHdoZXRoZXIgb3Igbm90IHRoZSBzbHVnIGhhcyBjaGFuZ2VkLlxuICpcbiAqIEByZXR1cm5zIHtib29sZWFufSBXaGV0aGVyIG9yIG5vdCB0aGUgc2x1ZyBoYXMgY2hhbmdlZC5cbiAqL1xuZnVuY3Rpb24gd3BzZW9TbHVnQ2hhbmdlZCgpIHtcblx0dmFyIGVkaXRvciAgICAgID0gd3BzZW9HZXRBY3RpdmVFZGl0b3IoKTtcblx0dmFyIHNsdWdGaWVsZCAgID0gd3BzZW9HZXRTbHVnRmllbGQoKTtcblx0dmFyIGN1cnJlbnRTbHVnID0gd3BzZW9HZXRDdXJyZW50U2x1ZygpO1xuXHR2YXIgbmV3U2x1ZyAgICAgPSAgZWRpdG9yLmZpbmQoIFwiaW5wdXRbbmFtZT1cIiArIHNsdWdGaWVsZCArIFwiXVwiICkudmFsKCk7XG5cblx0cmV0dXJuIGN1cnJlbnRTbHVnICE9PSBuZXdTbHVnO1xufVxuXG53aW5kb3cud3BzZW9TbHVnQ2hhbmdlZCA9IHdwc2VvU2x1Z0NoYW5nZWQ7XG5cbi8qKlxuICogR2V0cyB0aGUgY3VycmVudGx5IGFjdGl2ZSBlZGl0b3IgdXNlZCBpbiBxdWljayBlZGl0LlxuICpcbiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBlZGl0b3IgdGhhdCBpcyBjdXJyZW50bHkgYWN0aXZlLlxuICovXG5mdW5jdGlvbiB3cHNlb0dldEFjdGl2ZUVkaXRvcigpIHtcblx0cmV0dXJuIGpRdWVyeSggXCJ0ci5pbmxpbmUtZWRpdG9yXCIgKTtcbn1cblxud2luZG93Lndwc2VvR2V0QWN0aXZlRWRpdG9yID0gd3BzZW9HZXRBY3RpdmVFZGl0b3I7XG5cbi8qKlxuICogR2V0cyB0aGUgY3VycmVudCBwb3N0IG9yIHRlcm0gaWQuXG4gKiBSZXR1cm5zIGFuIGVtcHR5IHN0cmluZyBpZiBubyBlZGl0b3IgaXMgY3VycmVudGx5IGFjdGl2ZS5cbiAqXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgSUQgb2YgdGhlIGN1cnJlbnQgcG9zdCBvciB0ZXJtLlxuICovXG5mdW5jdGlvbiB3cHNlb0dldEl0ZW1JZCgpIHtcblx0dmFyIGVkaXRvciA9IHdwc2VvR2V0QWN0aXZlRWRpdG9yKCk7XG5cblx0aWYgKCBlZGl0b3IubGVuZ3RoID09PSAwIHx8IGVkaXRvciA9PT0gXCJcIiApIHtcblx0XHRyZXR1cm4gXCJcIjtcblx0fVxuXG5cdHJldHVybiBlZGl0b3IuYXR0ciggXCJpZFwiICkucmVwbGFjZSggXCJlZGl0LVwiLCBcIlwiICk7XG59XG5cbndpbmRvdy53cHNlb0dldEl0ZW1JZCA9IHdwc2VvR2V0SXRlbUlkO1xuXG4vKipcbiAqIEhhbmRsZXMgdGhlIGtleS1iYXNlZCBldmVudHMgaW4gdGhlIHF1aWNrIGVkaXQgZWRpdG9yLlxuICpcbiAqIEBwYXJhbSB7RXZlbnR9IGV2IFRoZSBldmVudCBjdXJyZW50bHkgYmVpbmcgZXhlY3V0ZWQuXG4gKlxuICogQHJldHVybnMge3ZvaWR9XG4gKi9cbmZ1bmN0aW9uIHdwc2VvSGFuZGxlS2V5RXZlbnRzKCBldiApIHtcblx0Ly8gMTMgcmVmZXJzIHRvIHRoZSBlbnRlciBrZXkuXG5cdGlmICggZXYud2hpY2ggPT09IDEzICYmIHdwc2VvU2x1Z0NoYW5nZWQoKSApIHtcblx0XHR3cHNlb1Nob3dOb3RpZmljYXRpb24oKTtcblx0fVxufVxuXG53aW5kb3cud3BzZW9IYW5kbGVLZXlFdmVudHMgPSB3cHNlb0hhbmRsZUtleUV2ZW50cztcblxuLyoqXG4gKiBIYW5kbGVzIHRoZSBidXR0b24tYmFzZWQgZXZlbnRzIGluIHRoZSBxdWljayBlZGl0IGVkaXRvci5cbiAqXG4gKiBAcGFyYW0ge0V2ZW50fSBldiBUaGUgZXZlbnQgY3VycmVudGx5IGJlaW5nIGV4ZWN1dGVkLlxuICpcbiAqIEByZXR1cm5zIHt2b2lkfVxuICovXG5mdW5jdGlvbiB3cHNlb0hhbmRsZUJ1dHRvbkV2ZW50cyggZXYgKSB7XG5cdGlmICggalF1ZXJ5KCBldi50YXJnZXQgKS5hdHRyKCBcImlkXCIgKSAhPT0gXCJzYXZlLW9yZGVyXCIgJiYgd3BzZW9TbHVnQ2hhbmdlZCgpICkge1xuXHRcdHdwc2VvU2hvd05vdGlmaWNhdGlvbigpO1xuXHR9XG59XG5cbndpbmRvdy53cHNlb0hhbmRsZUJ1dHRvbkV2ZW50cyA9IHdwc2VvSGFuZGxlQnV0dG9uRXZlbnRzO1xuXG53aW5kb3cud3BzZW9VbmRvUmVkaXJlY3QgPSByZWRpcmVjdEZ1bmN0aW9ucy53cHNlb1VuZG9SZWRpcmVjdDtcbndpbmRvdy53cHNlb0NyZWF0ZVJlZGlyZWN0ID0gcmVkaXJlY3RGdW5jdGlvbnMud3BzZW9DcmVhdGVSZWRpcmVjdDtcblxuKCBqUXVlcnkoIGZ1bmN0aW9uKCkge1xuXHR2YXIgd3BzZW9DdXJyZW50UGFnZSA9IHdwc2VvR2V0Q3VycmVudFBhZ2UoKTtcblxuXHRzd2l0Y2ggKCB3cHNlb0N1cnJlbnRQYWdlICkge1xuXG5cdFx0Ly8gVGVybXMgbGlzdCBzY3JlZW4uXG5cdFx0Y2FzZSBcImVkaXQtdGFncy5waHBcIjpcblx0XHRcdGpRdWVyeSggZG9jdW1lbnQgKS5vbiggXCJhamF4Q29tcGxldGVcIiwgZnVuY3Rpb24oIGUsIHhociwgc2V0dGluZ3MgKSB7XG5cdFx0XHRcdGlmICggc2V0dGluZ3MuZGF0YS5pbmRleE9mKCBcImFjdGlvbj1kZWxldGUtdGFnXCIgKSA+IC0xICkge1xuXHRcdFx0XHRcdHdwc2VvU2hvd05vdGlmaWNhdGlvbigpO1xuXHRcdFx0XHR9XG5cdFx0XHR9ICk7XG5cblx0XHQvLyBQb3N0cyBsaXN0IHNjcmVlbi5cblx0XHRjYXNlIFwiZWRpdC5waHBcIjpcblx0XHRcdGpRdWVyeSggXCIjaW5saW5lLWVkaXQgaW5wdXRcIiApLm9uKCBcImtleWRvd25cIiwgZnVuY3Rpb24oIGV2ICkge1xuXHRcdFx0XHR3cHNlb0hhbmRsZUtleUV2ZW50cyggZXYgKTtcblx0XHRcdH0gKTtcblxuXHRcdFx0alF1ZXJ5KCBcIi5idXR0b24tcHJpbWFyeVwiICkuY2xpY2soIGZ1bmN0aW9uKCBldiApIHtcblx0XHRcdFx0d3BzZW9IYW5kbGVCdXR0b25FdmVudHMoIGV2ICk7XG5cdFx0XHR9ICk7XG5cblx0XHRcdGJyZWFrO1xuXHR9XG59ICkgKTtcbiIsIi8qIGdsb2JhbCB3cHNlb1ByZW1pdW1TdHJpbmdzLCBhamF4dXJsICovXG5cbi8qKlxuICogVW5kb2VzIGEgcmVkaXJlY3QuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IG9yaWdpbiBUaGUgcmVkaXJlY3QncyBvcmlnaW4uXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFyZ2V0IFRoZSByZWRpcmVjdCdzIHRhcmdldC5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIFRoZSB0eXBlIG9mIHJlZGlyZWN0LlxuICogQHBhcmFtIHtzdHJpbmd9IG5vbmNlIFRoZSBub25jZSBiZWluZyB1c2VkIHRvIHZhbGlkYXRlIHRoZSBjdXJyZW50IEFKQVggcmVxdWVzdC5cbiAqIEBwYXJhbSB7b2JqZWN0fSBzb3VyY2UgVGhlIERPTUVsZW1lbnQgY29udGFpbmluZyB0aGUgYWxlcnRzLlxuICpcbiAqIEByZXR1cm5zIHt2b2lkfVxuICovXG5mdW5jdGlvbiB3cHNlb1VuZG9SZWRpcmVjdCggb3JpZ2luLCB0YXJnZXQsIHR5cGUsIG5vbmNlLCBzb3VyY2UgKSB7XG5cdGpRdWVyeS5wb3N0KFxuXHRcdGFqYXh1cmwsXG5cdFx0e1xuXHRcdFx0YWN0aW9uOiBcIndwc2VvX2RlbGV0ZV9yZWRpcmVjdF9wbGFpblwiLFxuXHRcdFx0YWpheF9ub25jZTogbm9uY2UsXG5cdFx0XHRyZWRpcmVjdDoge1xuXHRcdFx0XHRvcmlnaW46IG9yaWdpbixcblx0XHRcdFx0dGFyZ2V0OiB0YXJnZXQsXG5cdFx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHR9LFxuXHRcdH0sXG5cdFx0ZnVuY3Rpb24oKSB7XG5cdFx0XHRqUXVlcnkoIHNvdXJjZSApLmNsb3Nlc3QoIFwiLnlvYXN0LWFsZXJ0XCIgKS5mYWRlT3V0KCBcInNsb3dcIiApO1xuXHRcdH1cblx0KTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgcmVkaXJlY3RcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gb3JpZ2luIFRoZSBvcmlnaW4uXG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZSAgIFRoZSByZWRpcmVjdCB0eXBlLCByZWdleCBvciBwbGFpbi5cbiAqIEBwYXJhbSB7c3RyaW5nfSBub25jZSAgVGhlIG5vbmNlLlxuICogQHBhcmFtIHtvYmplY3R9IHNvdXJjZSBUaGUgc291cmNlIG9mIHRoZSByZWRpcmVjdC5cbiAqXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqL1xuZnVuY3Rpb24gd3BzZW9DcmVhdGVSZWRpcmVjdCggb3JpZ2luLCB0eXBlLCBub25jZSwgc291cmNlICkge1xuXHR2YXIgdGFyZ2V0ID0gXCJcIjtcblxuXHRpZiggcGFyc2VJbnQoIHR5cGUsIDEwICkgIT09IDQxMCApIHtcblx0XHQvKiBlc2xpbnQtZGlzYWJsZSBuby1hbGVydCAqL1xuXHRcdHRhcmdldCA9IHdpbmRvdy5wcm9tcHQoIHdwc2VvUHJlbWl1bVN0cmluZ3MuZW50ZXJfbmV3X3VybC5yZXBsYWNlKCBcIiVzXCIsIG9yaWdpbiApICk7XG5cdFx0LyogZXNsaW50LWVuYWJsZSBuby1hbGVydCAqL1xuXG5cdFx0aWYgKCB0YXJnZXQgPT09IFwiXCIgKSB7XG5cdFx0XHQvKiBlc2xpbnQtZGlzYWJsZSBuby1hbGVydCAqL1xuXHRcdFx0d2luZG93LmFsZXJ0KCB3cHNlb1ByZW1pdW1TdHJpbmdzLmVycm9yX25ld191cmwgKTtcblx0XHRcdC8qIGVzbGludC1lbmFibGUgbm8tYWxlcnQgKi9cblx0XHRcdHJldHVybjtcblx0XHR9XG5cdH1cblxuXHRqUXVlcnkucG9zdChcblx0XHRhamF4dXJsLFxuXHRcdHtcblx0XHRcdGFjdGlvbjogXCJ3cHNlb19hZGRfcmVkaXJlY3RfcGxhaW5cIixcblx0XHRcdGFqYXhfbm9uY2U6IG5vbmNlLFxuXHRcdFx0cmVkaXJlY3Q6IHtcblx0XHRcdFx0b3JpZ2luOiBvcmlnaW4sXG5cdFx0XHRcdHRhcmdldDogdGFyZ2V0LFxuXHRcdFx0XHR0eXBlOiB0eXBlLFxuXHRcdFx0fSxcblx0XHR9LFxuXHRcdGZ1bmN0aW9uKCByZXNwb25zZSApIHtcblx0XHRcdHZhciBub3RpY2UgPSBqUXVlcnkoIHNvdXJjZSApLmNsb3Nlc3QoIFwiLnlvYXN0LWFsZXJ0XCIgKTtcblx0XHRcdC8vIFJlbW92ZSB0aGUgY2xhc3NlcyBmaXJzdC5cblx0XHRcdGpRdWVyeSggbm90aWNlIClcblx0XHRcdFx0LnJlbW92ZUNsYXNzKCBcInVwZGF0ZWRcIiApXG5cdFx0XHRcdC5yZW1vdmVDbGFzcyggXCJlcnJvclwiICk7XG5cblx0XHRcdC8vIFJlbW92ZSBwb3NzaWJseSBhZGRlZCByZWRpcmVjdCBlcnJvcnMuXG5cdFx0XHRqUXVlcnkoIG5vdGljZSApLmZpbmQoIFwiLnJlZGlyZWN0X2Vycm9yXCIgKS5yZW1vdmUoKTtcblxuXHRcdFx0aWYoIHJlc3BvbnNlLmVycm9yICkge1xuXHRcdFx0XHQvLyBBZGQgcGFyYWdyYXBoIG9uIHRvcCBvZiB0aGUgbm90aWNlIHdpdGggYWN0aW9ucyBhbmQgc2V0IGNsYXNzIHRvIGVycm9yLlxuXHRcdFx0XHRqUXVlcnkoIG5vdGljZSApXG5cdFx0XHRcdFx0LmFkZENsYXNzKCBcImVycm9yXCIgKVxuXHRcdFx0XHRcdC5wcmVwZW5kKCBcIjxwIGNsYXNzPVxcXCJyZWRpcmVjdF9lcnJvclxcXCI+XCIgKyByZXNwb25zZS5lcnJvci5tZXNzYWdlICsgXCI8L3A+XCIgKTtcblxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8vIFBhcnNlIHRoZSBzdWNjZXNzIG1lc3NhZ2UuXG5cdFx0XHR2YXIgc3VjY2Vzc01lc3NhZ2UgPSBcIlwiO1xuXHRcdFx0aWYoIHBhcnNlSW50KCB0eXBlLCAxMCApID09PSA0MTAgKSB7XG5cdFx0XHRcdHN1Y2Nlc3NNZXNzYWdlID0gd3BzZW9QcmVtaXVtU3RyaW5ncy5yZWRpcmVjdF9zYXZlZF9ub190YXJnZXQ7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzdWNjZXNzTWVzc2FnZSA9IHdwc2VvUHJlbWl1bVN0cmluZ3MucmVkaXJlY3Rfc2F2ZWQucmVwbGFjZSggXCIlMiRzXCIsIFwiPGNvZGU+XCIgKyByZXNwb25zZS50YXJnZXQgKyBcIjwvY29kZT5cIiApO1xuXHRcdFx0fVxuXG5cdFx0XHRzdWNjZXNzTWVzc2FnZSA9IHN1Y2Nlc3NNZXNzYWdlLnJlcGxhY2UoIFwiJTEkc1wiLCBcIjxjb2RlPlwiICsgcmVzcG9uc2Uub3JpZ2luICsgXCI8L2NvZGU+XCIgKTtcblxuXHRcdFx0Ly8gU2V0IGNsYXNzIHRvIHVwZGF0ZWQgYW5kIHJlcGxhY2UgaHRtbCB3aXRoIHRoZSBzdWNjZXNzIG1lc3NhZ2UuXG5cdFx0XHRqUXVlcnkoIG5vdGljZSApXG5cdFx0XHRcdC5hZGRDbGFzcyggXCJ1cGRhdGVkXCIgKVxuXHRcdFx0XHQuaHRtbCggXCI8cD5cIiArIHN1Y2Nlc3NNZXNzYWdlICsgXCI8L3A+XCIgKTtcblx0XHR9LFxuXHRcdFwianNvblwiXG5cdCk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuXHR3cHNlb0NyZWF0ZVJlZGlyZWN0OiB3cHNlb0NyZWF0ZVJlZGlyZWN0LFxuXHR3cHNlb1VuZG9SZWRpcmVjdDogd3BzZW9VbmRvUmVkaXJlY3QsXG59O1xuIl19
