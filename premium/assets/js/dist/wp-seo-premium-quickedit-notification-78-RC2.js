(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";

/* global ajaxurl */
/* jshint -W097 */

var redirectFunctions = require("./redirects/functions");

/**
 * Use notification counter so we can count how many times the function wpseoShowNotification is called.
 *
 * @type {number}
 */
var wpseoNotificationCounter = 0;

/**
 * Show notification to user when there's a redirect created. When the response is empty, up the notification counter
 * with 1, wait 100 ms and call function again.
 * Stop when the notification counter is bigger than 20.
 *
 * @returns {void}
 */
function wpseoShowNotification() {
	jQuery.post(ajaxurl, { action: "yoast_get_notifications" }, function (response) {
		if (response !== "") {
			var insertAfterElement = jQuery(".wrap").children().eq(0);
			jQuery(response).insertAfter(insertAfterElement);
			wpseoNotificationCounter = 0;
		}

		if (wpseoNotificationCounter < 20 && response === "") {
			wpseoNotificationCounter++;
			setTimeout(wpseoShowNotification, 500);
		}
	});
}

window.wpseoShowNotification = wpseoShowNotification;

/**
 * Gets the current page based on the current URL.
 *
 * @returns {string} The current page.
 */
function wpseoGetCurrentPage() {
	return jQuery(location).attr("pathname").split("/").pop();
}

window.wpseoGetCurrentPage = wpseoGetCurrentPage;

/**
 * Gets the name of the field to get the slug from, based on the current URL.
 *
 * For posts, this is 'post_name', for terms it is 'slug'.
 *
 * @returns {string} The current slug field name.
 */
function wpseoGetSlugField(currentPage) {
	currentPage = currentPage || wpseoGetCurrentPage();

	if (currentPage === "edit-tags.php") {
		return "slug";
	}

	return "post_name";
}

/**
 * Gets the current slug of a post based on the current page and post or term being edited.
 *
 * @returns {string} The slug of the current post or term.
 */
function wpseoGetCurrentSlug() {
	var currentPost = wpseoGetItemId();
	var slugField = wpseoGetSlugField();

	return jQuery("#inline_" + currentPost).find("." + slugField).html();
}

window.wpseoGetCurrentSlug = wpseoGetCurrentSlug;

/**
 * Checks whether or not the slug has changed.
 *
 * @returns {boolean} Whether or not the slug has changed.
 */
function wpseoSlugChanged() {
	var editor = wpseoGetActiveEditor();
	var slugField = wpseoGetSlugField();
	var currentSlug = wpseoGetCurrentSlug();
	var newSlug = editor.find("input[name=" + slugField + "]").val();

	return currentSlug !== newSlug;
}

window.wpseoSlugChanged = wpseoSlugChanged;

/**
 * Gets the currently active editor used in quick edit.
 *
 * @returns {Object} The editor that is currently active.
 */
function wpseoGetActiveEditor() {
	return jQuery("tr.inline-editor");
}

window.wpseoGetActiveEditor = wpseoGetActiveEditor;

/**
 * Gets the current post or term id.
 * Returns an empty string if no editor is currently active.
 *
 * @returns {string} The ID of the current post or term.
 */
function wpseoGetItemId() {
	var editor = wpseoGetActiveEditor();

	if (editor.length === 0 || editor === "") {
		return "";
	}

	return editor.attr("id").replace("edit-", "");
}

window.wpseoGetItemId = wpseoGetItemId;

/**
 * Handles the key-based events in the quick edit editor.
 *
 * @param {Event} ev The event currently being executed.
 *
 * @returns {void}
 */
function wpseoHandleKeyEvents(ev) {
	// 13 refers to the enter key.
	if (ev.which === 13 && wpseoSlugChanged()) {
		wpseoShowNotification();
	}
}

window.wpseoHandleKeyEvents = wpseoHandleKeyEvents;

/**
 * Handles the button-based events in the quick edit editor.
 *
 * @param {Event} ev The event currently being executed.
 *
 * @returns {void}
 */
function wpseoHandleButtonEvents(ev) {
	if (jQuery(ev.target).attr("id") !== "save-order" && wpseoSlugChanged()) {
		wpseoShowNotification();
	}
}

window.wpseoHandleButtonEvents = wpseoHandleButtonEvents;

window.wpseoUndoRedirect = redirectFunctions.wpseoUndoRedirect;
window.wpseoCreateRedirect = redirectFunctions.wpseoCreateRedirect;

jQuery(function () {
	var wpseoCurrentPage = wpseoGetCurrentPage();

	if (["edit.php", "edit-tags.php"].includes(wpseoCurrentPage)) {
		jQuery("#inline-edit input").on("keydown", function (ev) {
			wpseoHandleKeyEvents(ev);
		});

		jQuery(".button-primary").click(function (ev) {
			wpseoHandleButtonEvents(ev);
		});
	}

	if (wpseoCurrentPage === "edit-tags.php") {
		jQuery(document).on("ajaxComplete", function (e, xhr, settings) {
			if (settings.data.indexOf("action=delete-tag") > -1) {
				wpseoShowNotification();
			}
		});
	}
});

},{"./redirects/functions":2}],2:[function(require,module,exports){
"use strict";

/* global wpseoPremiumStrings, ajaxurl */

/**
 * Undoes a redirect.
 *
 * @param {string} origin The redirect's origin.
 * @param {string} target The redirect's target.
 * @param {string} type The type of redirect.
 * @param {string} nonce The nonce being used to validate the current AJAX request.
 * @param {object} source The DOMElement containing the alerts.
 *
 * @returns {void}
 */
function wpseoUndoRedirect(origin, target, type, nonce, source) {
	jQuery.post(ajaxurl, {
		action: "wpseo_delete_redirect_plain",
		ajax_nonce: nonce,
		redirect: {
			origin: origin,
			target: target,
			type: type
		}
	}, function () {
		jQuery(source).closest(".yoast-alert").fadeOut("slow");
	});
}

/**
 * Creates a redirect
 *
 * @param {string} origin The origin.
 * @param {string} type   The redirect type, regex or plain.
 * @param {string} nonce  The nonce.
 * @param {object} source The source of the redirect.
 *
 * @returns {void}
 */
function wpseoCreateRedirect(origin, type, nonce, source) {
	var target = "";

	if (parseInt(type, 10) !== 410) {
		/* eslint-disable no-alert */
		target = window.prompt(wpseoPremiumStrings.enter_new_url.replace("%s", origin));
		/* eslint-enable no-alert */

		if (target === "") {
			/* eslint-disable no-alert */
			window.alert(wpseoPremiumStrings.error_new_url);
			/* eslint-enable no-alert */
			return;
		}
	}

	jQuery.post(ajaxurl, {
		action: "wpseo_add_redirect_plain",
		ajax_nonce: nonce,
		redirect: {
			origin: origin,
			target: target,
			type: type
		}
	}, function (response) {
		var notice = jQuery(source).closest(".yoast-alert");
		// Remove the classes first.
		jQuery(notice).removeClass("updated").removeClass("error");

		// Remove possibly added redirect errors.
		jQuery(notice).find(".redirect_error").remove();

		if (response.error) {
			// Add paragraph on top of the notice with actions and set class to error.
			jQuery(notice).addClass("error").prepend("<p class=\"redirect_error\">" + response.error.message + "</p>");

			return;
		}

		// Parse the success message.
		var successMessage = "";
		if (parseInt(type, 10) === 410) {
			successMessage = wpseoPremiumStrings.redirect_saved_no_target;
		} else {
			successMessage = wpseoPremiumStrings.redirect_saved.replace("%2$s", "<code>" + response.target + "</code>");
		}

		successMessage = successMessage.replace("%1$s", "<code>" + response.origin + "</code>");

		// Set class to updated and replace html with the success message.
		jQuery(notice).addClass("updated").html("<p>" + successMessage + "</p>");
	}, "json");
}

module.exports = {
	wpseoCreateRedirect: wpseoCreateRedirect,
	wpseoUndoRedirect: wpseoUndoRedirect
};

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhc3NldHMvanMvc3JjL3F1aWNrZWRpdC1ub3RpZmljYXRpb24uanMiLCJhc3NldHMvanMvc3JjL3JlZGlyZWN0cy9mdW5jdGlvbnMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBO0FBQ0E7O0FBRUEsSUFBSSxvQkFBb0IsUUFBUyx1QkFBVCxDQUF4Qjs7QUFFQTs7Ozs7QUFLQSxJQUFJLDJCQUEyQixDQUEvQjs7QUFFQTs7Ozs7OztBQU9BLFNBQVMscUJBQVQsR0FBaUM7QUFDaEMsUUFBTyxJQUFQLENBQ0MsT0FERCxFQUVDLEVBQUUsUUFBUSx5QkFBVixFQUZELEVBR0MsVUFBVSxRQUFWLEVBQXFCO0FBQ3BCLE1BQUssYUFBYSxFQUFsQixFQUF1QjtBQUN0QixPQUFJLHFCQUFxQixPQUFRLE9BQVIsRUFBa0IsUUFBbEIsR0FBNkIsRUFBN0IsQ0FBaUMsQ0FBakMsQ0FBekI7QUFDQSxVQUFRLFFBQVIsRUFBbUIsV0FBbkIsQ0FBZ0Msa0JBQWhDO0FBQ0EsOEJBQTJCLENBQTNCO0FBQ0E7O0FBRUQsTUFBSywyQkFBMkIsRUFBM0IsSUFBaUMsYUFBYSxFQUFuRCxFQUF3RDtBQUN2RDtBQUNBLGNBQVkscUJBQVosRUFBbUMsR0FBbkM7QUFDQTtBQUNELEVBZEY7QUFnQkE7O0FBRUQsT0FBTyxxQkFBUCxHQUErQixxQkFBL0I7O0FBRUE7Ozs7O0FBS0EsU0FBUyxtQkFBVCxHQUErQjtBQUM5QixRQUFPLE9BQVEsUUFBUixFQUFtQixJQUFuQixDQUF5QixVQUF6QixFQUFzQyxLQUF0QyxDQUE2QyxHQUE3QyxFQUFtRCxHQUFuRCxFQUFQO0FBQ0E7O0FBRUQsT0FBTyxtQkFBUCxHQUE2QixtQkFBN0I7O0FBRUE7Ozs7Ozs7QUFPQSxTQUFTLGlCQUFULENBQTRCLFdBQTVCLEVBQTBDO0FBQ3pDLGVBQWMsZUFBZSxxQkFBN0I7O0FBRUEsS0FBSyxnQkFBZ0IsZUFBckIs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cUI7QUFDcEI7QUFDQSxVQUFRLE1BQVIsRUFDRSxRQURGLENBQ1ksT0FEWixFQUVFLE9BRkYsQ0FFVyxpQ0FBaUMsU0FBUyxLQUFULENBQWUsT0FBaEQsR0FBMEQsTUFGckU7O0FBSUE7QUFDQTs7QUFFRDtBQUNBLE1BQUksaUJBQWlCLEVBQXJCO0FBQ0EsTUFBSSxTQUFVLElBQVYsRUFBZ0IsRUFBaEIsTUFBeUIsR0FBN0IsRUFBbUM7QUFDbEMsb0JBQWlCLG9CQUFvQix3QkFBckM7QUFDQSxHQUZELE1BRU87QUFDTixvQkFBaUIsb0JBQW9CLGNBQXBCLENBQW1DLE9BQW5DLENBQTRDLE1BQTVDLEVBQW9ELFdBQVcsU0FBUyxNQUFwQixHQUE2QixTQUFqRixDQUFqQjtBQUNBOztBQUVELG1CQUFpQixlQUFlLE9BQWYsQ0FBd0IsTUFBeEIsRUFBZ0MsV0FBVyxTQUFTLE1BQXBCLEdBQTZCLFNBQTdELENBQWpCOztBQUVBO0FBQ0EsU0FBUSxNQUFSLEVBQ0UsUUFERixDQUNZLFNBRFosRUFFRSxJQUZGLENBRVEsUUFBUSxjQUFSLEdBQXlCLE1BRmpDO0FBR0EsRUE1Q0YsRUE2Q0MsTUE3Q0Q7QUErQ0E7O0FBRUQsT0FBTyxPQUFQLEdBQWlCO0FBQ2hCLHNCQUFxQixtQkFETDtBQUVoQixvQkFBbUI7QUFGSCxDQUFqQiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKiBnbG9iYWwgYWpheHVybCAqL1xuLyoganNoaW50IC1XMDk3ICovXG5cbnZhciByZWRpcmVjdEZ1bmN0aW9ucyA9IHJlcXVpcmUoIFwiLi9yZWRpcmVjdHMvZnVuY3Rpb25zXCIgKTtcblxuLyoqXG4gKiBVc2Ugbm90aWZpY2F0aW9uIGNvdW50ZXIgc28gd2UgY2FuIGNvdW50IGhvdyBtYW55IHRpbWVzIHRoZSBmdW5jdGlvbiB3cHNlb1Nob3dOb3RpZmljYXRpb24gaXMgY2FsbGVkLlxuICpcbiAqIEB0eXBlIHtudW1iZXJ9XG4gKi9cbnZhciB3cHNlb05vdGlmaWNhdGlvbkNvdW50ZXIgPSAwO1xuXG4vKipcbiAqIFNob3cgbm90aWZpY2F0aW9uIHRvIHVzZXIgd2hlbiB0aGVyZSdzIGEgcmVkaXJlY3QgY3JlYXRlZC4gV2hlbiB0aGUgcmVzcG9uc2UgaXMgZW1wdHksIHVwIHRoZSBub3RpZmljYXRpb24gY291bnRlclxuICogd2l0aCAxLCB3YWl0IDEwMCBtcyBhbmQgY2FsbCBmdW5jdGlvbiBhZ2Fpbi5cbiAqIFN0b3Agd2hlbiB0aGUgbm90aWZpY2F0aW9uIGNvdW50ZXIgaXMgYmlnZ2VyIHRoYW4gMjAuXG4gKlxuICogQHJldHVybnMge3ZvaWR9XG4gKi9cbmZ1bmN0aW9uIHdwc2VvU2hvd05vdGlmaWNhdGlvbigpIHtcblx0alF1ZXJ5LnBvc3QoXG5cdFx0YWpheHVybCxcblx0XHR7IGFjdGlvbjogXCJ5b2FzdF9nZXRfbm90aWZpY2F0aW9uc1wiIH0sXG5cdFx0ZnVuY3Rpb24oIHJlc3BvbnNlICkge1xuXHRcdFx0aWYgKCByZXNwb25zZSAhPT0gXCJcIiApIHtcblx0XHRcdFx0dmFyIGluc2VydEFmdGVyRWxlbWVudCA9IGpRdWVyeSggXCIud3JhcFwiICkuY2hpbGRyZW4oKS5lcSggMCApO1xuXHRcdFx0XHRqUXVlcnkoIHJlc3BvbnNlICkuaW5zZXJ0QWZ0ZXIoIGluc2VydEFmdGVyRWxlbWVudCApO1xuXHRcdFx0XHR3cHNlb05vdGlmaWNhdGlvbkNvdW50ZXIgPSAwO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIHdwc2VvTm90aWZpY2F0aW9uQ291bnRlciA8IDIwICYmIHJlc3BvbnNlID09PSBcIlwiICkge1xuXHRcdFx0XHR3cHNlb05vdGlmaWNhdGlvbkNvdW50ZXIrKztcblx0XHRcdFx0c2V0VGltZW91dCggd3BzZW9TaG93Tm90aWZpY2F0aW9uLCA1MDAgKTtcblx0XHRcdH1cblx0XHR9XG5cdCk7XG59XG5cbndpbmRvdy53cHNlb1Nob3dOb3RpZmljYXRpb24gPSB3cHNlb1Nob3dOb3RpZmljYXRpb247XG5cbi8qKlxuICogR2V0cyB0aGUgY3VycmVudCBwYWdlIGJhc2VkIG9uIHRoZSBjdXJyZW50IFVSTC5cbiAqXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgY3VycmVudCBwYWdlLlxuICovXG5mdW5jdGlvbiB3cHNlb0dldEN1cnJlbnRQYWdlKCkge1xuXHRyZXR1cm4galF1ZXJ5KCBsb2NhdGlvbiApLmF0dHIoIFwicGF0aG5hbWVcIiApLnNwbGl0KCBcIi9cIiApLnBvcCgpO1xufVxuXG53aW5kb3cud3BzZW9HZXRDdXJyZW50UGFnZSA9IHdwc2VvR2V0Q3VycmVudFBhZ2U7XG5cbi8qKlxuICogR2V0cyB0aGUgbmFtZSBvZiB0aGUgZmllbGQgdG8gZ2V0IHRoZSBzbHVnIGZyb20sIGJhc2VkIG9uIHRoZSBjdXJyZW50IFVSTC5cbiAqXG4gKiBGb3IgcG9zdHMsIHRoaXMgaXMgJ3Bvc3RfbmFtZScsIGZvciB0ZXJtcyBpdCBpcyAnc2x1ZycuXG4gKlxuICogQHJldHVybnMge3N0cmluZ30gVGhlIGN1cnJlbnQgc2x1ZyBmaWVsZCBuYW1lLlxuICovXG5mdW5jdGlvbiB3cHNlb0dldFNsdWdGaWVsZCggY3VycmVudFBhZ2UgKSB7XG5cdGN1cnJlbnRQYWdlID0gY3VycmVudFBhZ2UgfHwgd3BzZW9HZXRDdXJyZW50UGFnZSgpO1xuXG5cdGlmICggY3VycmVudFBhZ2UgPT09IFwiZWRpdC10YWdzLnBocFwiICkge1xuXHRcdHJldHVybiBcInNsdWdcIjtcblx0fVxuXG5cdHJldHVybiBcInBvc3RfbmFtZVwiO1xufVxuXG4vKipcbiAqIEdldHMgdGhlIGN1cnJlbnQgc2x1ZyBvZiBhIHBvc3QgYmFzZWQgb24gdGhlIGN1cnJlbnQgcGFnZSBhbmQgcG9zdCBvciB0ZXJtIGJlaW5nIGVkaXRlZC5cbiAqXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgc2x1ZyBvZiB0aGUgY3VycmVudCBwb3N0IG9yIHRlcm0uXG4gKi9cbmZ1bmN0aW9uIHdwc2VvR2V0Q3VycmVudFNsdWcoKSB7XG5cdHZhciBjdXJyZW50UG9zdCA9IHdwc2VvR2V0SXRlbUlkKCk7XG5cdHZhciBzbHVnRmllbGQgICA9IHdwc2VvR2V0U2x1Z0ZpZWxkKCk7XG5cblx0cmV0dXJuIGpRdWVyeSggXCIjaW5saW5lX1wiICsgY3VycmVudFBvc3QgKS5maW5kKCBcIi5cIiArIHNsdWdGaWVsZCApLmh0bWwoKTtcbn1cblxud2luZG93Lndwc2VvR2V0Q3VycmVudFNsdWcgPSB3cHNlb0dldEN1cnJlbnRTbHVnO1xuXG4vKipcbiAqIENoZWNrcyB3aGV0aGVyIG9yIG5vdCB0aGUgc2x1ZyBoYXMgY2hhbmdlZC5cbiAqXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gV2hldGhlciBvciBub3QgdGhlIHNsdWcgaGFzIGNoYW5nZWQuXG4gKi9cbmZ1bmN0aW9uIHdwc2VvU2x1Z0NoYW5nZWQoKSB7XG5cdHZhciBlZGl0b3IgICAgICA9IHdwc2VvR2V0QWN0aXZlRWRpdG9yKCk7XG5cdHZhciBzbHVnRmllbGQgICA9IHdwc2VvR2V0U2x1Z0ZpZWxkKCk7XG5cdHZhciBjdXJyZW50U2x1ZyA9IHdwc2VvR2V0Q3VycmVudFNsdWcoKTtcblx0dmFyIG5ld1NsdWcgICAgID0gIGVkaXRvci5maW5kKCBcImlucHV0W25hbWU9XCIgKyBzbHVnRmllbGQgKyBcIl1cIiApLnZhbCgpO1xuXG5cdHJldHVybiBjdXJyZW50U2x1ZyAhPT0gbmV3U2x1Zztcbn1cblxud2luZG93Lndwc2VvU2x1Z0NoYW5nZWQgPSB3cHNlb1NsdWdDaGFuZ2VkO1xuXG4vKipcbiAqIEdldHMgdGhlIGN1cnJlbnRseSBhY3RpdmUgZWRpdG9yIHVzZWQgaW4gcXVpY2sgZWRpdC5cbiAqXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBUaGUgZWRpdG9yIHRoYXQgaXMgY3VycmVudGx5IGFjdGl2ZS5cbiAqL1xuZnVuY3Rpb24gd3BzZW9HZXRBY3RpdmVFZGl0b3IoKSB7XG5cdHJldHVybiBqUXVlcnkoIFwidHIuaW5saW5lLWVkaXRvclwiICk7XG59XG5cbndpbmRvdy53cHNlb0dldEFjdGl2ZUVkaXRvciA9IHdwc2VvR2V0QWN0aXZlRWRpdG9yO1xuXG4vKipcbiAqIEdldHMgdGhlIGN1cnJlbnQgcG9zdCBvciB0ZXJtIGlkLlxuICogUmV0dXJucyBhbiBlbXB0eSBzdHJpbmcgaWYgbm8gZWRpdG9yIGlzIGN1cnJlbnRseSBhY3RpdmUuXG4gKlxuICogQHJldHVybnMge3N0cmluZ30gVGhlIElEIG9mIHRoZSBjdXJyZW50IHBvc3Qgb3IgdGVybS5cbiAqL1xuZnVuY3Rpb24gd3BzZW9HZXRJdGVtSWQoKSB7XG5cdHZhciBlZGl0b3IgPSB3cHNlb0dldEFjdGl2ZUVkaXRvcigpO1xuXG5cdGlmICggZWRpdG9yLmxlbmd0aCA9PT0gMCB8fCBlZGl0b3IgPT09IFwiXCIgKSB7XG5cdFx0cmV0dXJuIFwiXCI7XG5cdH1cblxuXHRyZXR1cm4gZWRpdG9yLmF0dHIoIFwiaWRcIiApLnJlcGxhY2UoIFwiZWRpdC1cIiwgXCJcIiApO1xufVxuXG53aW5kb3cud3BzZW9HZXRJdGVtSWQgPSB3cHNlb0dldEl0ZW1JZDtcblxuLyoqXG4gKiBIYW5kbGVzIHRoZSBrZXktYmFzZWQgZXZlbnRzIGluIHRoZSBxdWljayBlZGl0IGVkaXRvci5cbiAqXG4gKiBAcGFyYW0ge0V2ZW50fSBldiBUaGUgZXZlbnQgY3VycmVudGx5IGJlaW5nIGV4ZWN1dGVkLlxuICpcbiAqIEByZXR1cm5zIHt2b2lkfVxuICovXG5mdW5jdGlvbiB3cHNlb0hhbmRsZUtleUV2ZW50cyggZXYgKSB7XG5cdC8vIDEzIHJlZmVycyB0byB0aGUgZW50ZXIga2V5LlxuXHRpZiAoIGV2LndoaWNoID09PSAxMyAmJiB3cHNlb1NsdWdDaGFuZ2VkKCkgKSB7XG5cdFx0d3BzZW9TaG93Tm90aWZpY2F0aW9uKCk7XG5cdH1cbn1cblxud2luZG93Lndwc2VvSGFuZGxlS2V5RXZlbnRzID0gd3BzZW9IYW5kbGVLZXlFdmVudHM7XG5cbi8qKlxuICogSGFuZGxlcyB0aGUgYnV0dG9uLWJhc2VkIGV2ZW50cyBpbiB0aGUgcXVpY2sgZWRpdCBlZGl0b3IuXG4gKlxuICogQHBhcmFtIHtFdmVudH0gZXYgVGhlIGV2ZW50IGN1cnJlbnRseSBiZWluZyBleGVjdXRlZC5cbiAqXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqL1xuZnVuY3Rpb24gd3BzZW9IYW5kbGVCdXR0b25FdmVudHMoIGV2ICkge1xuXHRpZiAoIGpRdWVyeSggZXYudGFyZ2V0ICkuYXR0ciggXCJpZFwiICkgIT09IFwic2F2ZS1vcmRlclwiICYmIHdwc2VvU2x1Z0NoYW5nZWQoKSApIHtcblx0XHR3cHNlb1Nob3dOb3RpZmljYXRpb24oKTtcblx0fVxufVxuXG53aW5kb3cud3BzZW9IYW5kbGVCdXR0b25FdmVudHMgPSB3cHNlb0hhbmRsZUJ1dHRvbkV2ZW50cztcblxud2luZG93Lndwc2VvVW5kb1JlZGlyZWN0ID0gcmVkaXJlY3RGdW5jdGlvbnMud3BzZW9VbmRvUmVkaXJlY3Q7XG53aW5kb3cud3BzZW9DcmVhdGVSZWRpcmVjdCA9IHJlZGlyZWN0RnVuY3Rpb25zLndwc2VvQ3JlYXRlUmVkaXJlY3Q7XG5cbiggalF1ZXJ5KCBmdW5jdGlvbigpIHtcblx0dmFyIHdwc2VvQ3VycmVudFBhZ2UgPSB3cHNlb0dldEN1cnJlbnRQYWdlKCk7XG5cblx0aWYgKCBbIFwiZWRpdC5waHBcIiwgXCJlZGl0LXRhZ3MucGhwXCIgXS5pbmNsdWRlcyggd3BzZW9DdXJyZW50UGFnZSApICkge1xuXHRcdGpRdWVyeSggXCIjaW5saW5lLWVkaXQgaW5wdXRcIiApLm9uKCBcImtleWRvd25cIiwgZnVuY3Rpb24oIGV2ICkge1xuXHRcdFx0d3BzZW9IYW5kbGVLZXlFdmVudHMoIGV2ICk7XG5cdFx0fSApO1xuXG5cdFx0alF1ZXJ5KCBcIi5idXR0b24tcHJpbWFyeVwiICkuY2xpY2soIGZ1bmN0aW9uKCBldiApIHtcblx0XHRcdHdwc2VvSGFuZGxlQnV0dG9uRXZlbnRzKCBldiApO1xuXHRcdH0gKTtcblx0fVxuXG5cdGlmICggd3BzZW9DdXJyZW50UGFnZSA9PT0gXCJlZGl0LXRhZ3MucGhwXCIgKSB7XG5cdFx0alF1ZXJ5KCBkb2N1bWVudCApLm9uKCBcImFqYXhDb21wbGV0ZVwiLCBmdW5jdGlvbiggZSwgeGhyLCBzZXR0aW5ncyApIHtcblx0XHRcdGlmICggc2V0dGluZ3MuZGF0YS5pbmRleE9mKCBcImFjdGlvbj1kZWxldGUtdGFnXCIgKSA+IC0xICkge1xuXHRcdFx0XHR3cHNlb1Nob3dOb3RpZmljYXRpb24oKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cdH1cbn0gKSApO1xuIiwiLyogZ2xvYmFsIHdwc2VvUHJlbWl1bVN0cmluZ3MsIGFqYXh1cmwgKi9cblxuLyoqXG4gKiBVbmRvZXMgYSByZWRpcmVjdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gb3JpZ2luIFRoZSByZWRpcmVjdCdzIG9yaWdpbi5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0YXJnZXQgVGhlIHJlZGlyZWN0J3MgdGFyZ2V0LlxuICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgVGhlIHR5cGUgb2YgcmVkaXJlY3QuXG4gKiBAcGFyYW0ge3N0cmluZ30gbm9uY2UgVGhlIG5vbmNlIGJlaW5nIHVzZWQgdG8gdmFsaWRhdGUgdGhlIGN1cnJlbnQgQUpBWCByZXF1ZXN0LlxuICogQHBhcmFtIHtvYmplY3R9IHNvdXJjZSBUaGUgRE9NRWxlbWVudCBjb250YWluaW5nIHRoZSBhbGVydHMuXG4gKlxuICogQHJldHVybnMge3ZvaWR9XG4gKi9cbmZ1bmN0aW9uIHdwc2VvVW5kb1JlZGlyZWN0KCBvcmlnaW4sIHRhcmdldCwgdHlwZSwgbm9uY2UsIHNvdXJjZSApIHtcblx0alF1ZXJ5LnBvc3QoXG5cdFx0YWpheHVybCxcblx0XHR7XG5cdFx0XHRhY3Rpb246IFwid3BzZW9fZGVsZXRlX3JlZGlyZWN0X3BsYWluXCIsXG5cdFx0XHRhamF4X25vbmNlOiBub25jZSxcblx0XHRcdHJlZGlyZWN0OiB7XG5cdFx0XHRcdG9yaWdpbjogb3JpZ2luLFxuXHRcdFx0XHR0YXJnZXQ6IHRhcmdldCxcblx0XHRcdFx0dHlwZTogdHlwZSxcblx0XHRcdH0sXG5cdFx0fSxcblx0XHRmdW5jdGlvbigpIHtcblx0XHRcdGpRdWVyeSggc291cmNlICkuY2xvc2VzdCggXCIueW9hc3QtYWxlcnRcIiApLmZhZGVPdXQoIFwic2xvd1wiICk7XG5cdFx0fVxuXHQpO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSByZWRpcmVjdFxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBvcmlnaW4gVGhlIG9yaWdpbi5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlICAgVGhlIHJlZGlyZWN0IHR5cGUsIHJlZ2V4IG9yIHBsYWluLlxuICogQHBhcmFtIHtzdHJpbmd9IG5vbmNlICBUaGUgbm9uY2UuXG4gKiBAcGFyYW0ge29iamVjdH0gc291cmNlIFRoZSBzb3VyY2Ugb2YgdGhlIHJlZGlyZWN0LlxuICpcbiAqIEByZXR1cm5zIHt2b2lkfVxuICovXG5mdW5jdGlvbiB3cHNlb0NyZWF0ZVJlZGlyZWN0KCBvcmlnaW4sIHR5cGUsIG5vbmNlLCBzb3VyY2UgKSB7XG5cdHZhciB0YXJnZXQgPSBcIlwiO1xuXG5cdGlmKCBwYXJzZUludCggdHlwZSwgMTAgKSAhPT0gNDEwICkge1xuXHRcdC8qIGVzbGludC1kaXNhYmxlIG5vLWFsZXJ0ICovXG5cdFx0dGFyZ2V0ID0gd2luZG93LnByb21wdCggd3BzZW9QcmVtaXVtU3RyaW5ncy5lbnRlcl9uZXdfdXJsLnJlcGxhY2UoIFwiJXNcIiwgb3JpZ2luICkgKTtcblx0XHQvKiBlc2xpbnQtZW5hYmxlIG5vLWFsZXJ0ICovXG5cblx0XHRpZiAoIHRhcmdldCA9PT0gXCJcIiApIHtcblx0XHRcdC8qIGVzbGludC1kaXNhYmxlIG5vLWFsZXJ0ICovXG5cdFx0XHR3aW5kb3cuYWxlcnQoIHdwc2VvUHJlbWl1bVN0cmluZ3MuZXJyb3JfbmV3X3VybCApO1xuXHRcdFx0LyogZXNsaW50LWVuYWJsZSBuby1hbGVydCAqL1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0fVxuXG5cdGpRdWVyeS5wb3N0KFxuXHRcdGFqYXh1cmwsXG5cdFx0e1xuXHRcdFx0YWN0aW9uOiBcIndwc2VvX2FkZF9yZWRpcmVjdF9wbGFpblwiLFxuXHRcdFx0YWpheF9ub25jZTogbm9uY2UsXG5cdFx0XHRyZWRpcmVjdDoge1xuXHRcdFx0XHRvcmlnaW46IG9yaWdpbixcblx0XHRcdFx0dGFyZ2V0OiB0YXJnZXQsXG5cdFx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHR9LFxuXHRcdH0sXG5cdFx0ZnVuY3Rpb24oIHJlc3BvbnNlICkge1xuXHRcdFx0dmFyIG5vdGljZSA9IGpRdWVyeSggc291cmNlICkuY2xvc2VzdCggXCIueW9hc3QtYWxlcnRcIiApO1xuXHRcdFx0Ly8gUmVtb3ZlIHRoZSBjbGFzc2VzIGZpcnN0LlxuXHRcdFx0alF1ZXJ5KCBub3RpY2UgKVxuXHRcdFx0XHQucmVtb3ZlQ2xhc3MoIFwidXBkYXRlZFwiIClcblx0XHRcdFx0LnJlbW92ZUNsYXNzKCBcImVycm9yXCIgKTtcblxuXHRcdFx0Ly8gUmVtb3ZlIHBvc3NpYmx5IGFkZGVkIHJlZGlyZWN0IGVycm9ycy5cblx0XHRcdGpRdWVyeSggbm90aWNlICkuZmluZCggXCIucmVkaXJlY3RfZXJyb3JcIiApLnJlbW92ZSgpO1xuXG5cdFx0XHRpZiggcmVzcG9uc2UuZXJyb3IgKSB7XG5cdFx0XHRcdC8vIEFkZCBwYXJhZ3JhcGggb24gdG9wIG9mIHRoZSBub3RpY2Ugd2l0aCBhY3Rpb25zIGFuZCBzZXQgY2xhc3MgdG8gZXJyb3IuXG5cdFx0XHRcdGpRdWVyeSggbm90aWNlIClcblx0XHRcdFx0XHQuYWRkQ2xhc3MoIFwiZXJyb3JcIiApXG5cdFx0XHRcdFx0LnByZXBlbmQoIFwiPHAgY2xhc3M9XFxcInJlZGlyZWN0X2Vycm9yXFxcIj5cIiArIHJlc3BvbnNlLmVycm9yLm1lc3NhZ2UgKyBcIjwvcD5cIiApO1xuXG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gUGFyc2UgdGhlIHN1Y2Nlc3MgbWVzc2FnZS5cblx0XHRcdHZhciBzdWNjZXNzTWVzc2FnZSA9IFwiXCI7XG5cdFx0XHRpZiggcGFyc2VJbnQoIHR5cGUsIDEwICkgPT09IDQxMCApIHtcblx0XHRcdFx0c3VjY2Vzc01lc3NhZ2UgPSB3cHNlb1ByZW1pdW1TdHJpbmdzLnJlZGlyZWN0X3NhdmVkX25vX3RhcmdldDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHN1Y2Nlc3NNZXNzYWdlID0gd3BzZW9QcmVtaXVtU3RyaW5ncy5yZWRpcmVjdF9zYXZlZC5yZXBsYWNlKCBcIiUyJHNcIiwgXCI8Y29kZT5cIiArIHJlc3BvbnNlLnRhcmdldCArIFwiPC9jb2RlPlwiICk7XG5cdFx0XHR9XG5cblx0XHRcdHN1Y2Nlc3NNZXNzYWdlID0gc3VjY2Vzc01lc3NhZ2UucmVwbGFjZSggXCIlMSRzXCIsIFwiPGNvZGU+XCIgKyByZXNwb25zZS5vcmlnaW4gKyBcIjwvY29kZT5cIiApO1xuXG5cdFx0XHQvLyBTZXQgY2xhc3MgdG8gdXBkYXRlZCBhbmQgcmVwbGFjZSBodG1sIHdpdGggdGhlIHN1Y2Nlc3MgbWVzc2FnZS5cblx0XHRcdGpRdWVyeSggbm90aWNlIClcblx0XHRcdFx0LmFkZENsYXNzKCBcInVwZGF0ZWRcIiApXG5cdFx0XHRcdC5odG1sKCBcIjxwPlwiICsgc3VjY2Vzc01lc3NhZ2UgKyBcIjwvcD5cIiApO1xuXHRcdH0sXG5cdFx0XCJqc29uXCJcblx0KTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG5cdHdwc2VvQ3JlYXRlUmVkaXJlY3Q6IHdwc2VvQ3JlYXRlUmVkaXJlY3QsXG5cdHdwc2VvVW5kb1JlZGlyZWN0OiB3cHNlb1VuZG9SZWRpcmVjdCxcbn07XG4iXX0=
