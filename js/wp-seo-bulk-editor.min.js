var bulk_editor=function(a){var b=a.find("[class^=wpseo-new]").first().attr("class"),c="#"+b+"-",d=c.replace("new","existing"),e=a.find("th[id^=col_existing_yoast]").first().text().replace("Existing ",""),f=b.replace("-new-","_save_"),g="wpseo_save_all_"+a.attr("class").split("wpseo_bulk_")[1],h=f.replace("wpseo_save_",""),i={new_class:"."+b,new_id:c,existing_id:d},j={submit_new:function(a){var b=i.new_id+a,c=i.existing_id+a;if("select-one"==jQuery(i.new_id+a).prop("type"))var d=jQuery(b).find(":selected").text();else var d=jQuery(b).val();var g=jQuery(c).html();if(d==g)jQuery(b).val("").focus();else{if(""==d&&!confirm("Are you sure you want to remove the existing "+e+"?"))return jQuery(b).focus(),void jQuery(b).val("").focus();var h={action:f,_ajax_nonce:wpseo_bulk_editor_nonce,wpseo_post_id:a,new_value:d,existing_value:g};jQuery.post(ajaxurl,h,j.handle_response)}},submit_all:function(a){a.preventDefault();var b={action:g,_ajax_nonce:wpseo_bulk_editor_nonce};b.send=!1,b.items={},b.existing_items={},jQuery(i.new_class).each(function(){var a=jQuery(this).data("id"),c=jQuery(this).val(),d=jQuery(i.existing_id+a).html();""!=c&&(c==d?jQuery(i.new_id+a).val("").focus():(b.send=!0,b.items[a]=c,b.existing_items[a]=d))}),b.send&&jQuery.post(ajaxurl,b,j.handle_responses)},handle_response:function(a,b){if("success"==b){var c=a;if("string"==typeof c&&(c=JSON.parse(c)),c instanceof Array)jQuery.each(c,function(){j.handle_response(this,b)});else if("success"==c.status){var d=c["new_"+h];jQuery(i.existing_id+c.post_id).html(d.replace(/\\(?!\\)/g,"")),jQuery(i.new_id+c.post_id).val("").focus()}else alert("Failure")}},handle_responses:function(a,b){var c=jQuery.parseJSON(a);jQuery.each(c,function(){j.handle_response(this,b)})},set_events:function(){a.find(".wpseo-save").click(function(){var a=jQuery(this).data("id");j.submit_new(a,this)}),a.find(".wpseo-save-all").click(j.submit_all),a.find(i.new_class).keypress(function(a){if(13==a.which){a.preventDefault();var b=jQuery(this).data("id");j.submit_new(b,this)}})}};return j};jQuery(document).ready(function(){var a=jQuery('table[class*="wpseo_bulk"]');a.each(function(a,b){var c=jQuery(b),d=bulk_editor(c);d.set_events()})});