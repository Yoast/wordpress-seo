!function(a){"use strict";function b(a){return""===a.responseText?jQuery("#title").val():jQuery("<div>"+a.responseText+"</div>").find("#editable-post-name-full").text()}function c(a){var b=a.getData(),c={targetElement:document.getElementById("wpseosnippet"),placeholder:{urlPath:""},defaultValue:{},baseURL:wpseoPostScraperL10n.base_url,callbacks:{saveSnippetData:a.saveSnippetData.bind(a)},metaDescriptionDate:wpseoPostScraperL10n.metaDescriptionDate,data:{title:b.snippetTitle,urlPath:b.snippetCite,metaDesc:b.snippetMeta}},d=wpseoPostScraperL10n.title_template;""===d&&(d="%%title%% - %%sitename%%"),c.placeholder.title=d,c.defaultValue.title=d;var e=wpseoPostScraperL10n.metadesc_template;return""!==e&&(c.placeholder.metaDesc=e,c.defaultValue.metaDesc=e),new YoastSEO.SnippetPreview(c)}var d="",e=function(){"object"==typeof CKEDITOR&&console.warn("YoastSEO currently doesn't support ckEditor. The content analysis currently only works with the HTML editor or TinyMCE."),this.prepareSlugBinding()};e.prototype.prepareSlugBinding=function(){if(null===document.getElementById("editable-post-name")){var a=this;jQuery(document).on("after-autosave.update-post-slug",function(){a.bindSnippetCiteEvents(0)})}else this.bindSlugEditor()},e.prototype.bindSnippetCiteEvents=function(a){a=a||0;var b=document.getElementById("editable-post-name"),c=document.getElementById("title"),d=document.getElementById("post_name");null!==b&&""!==c.value?(this.bindSlugEditor(),d.value=document.getElementById("editable-post-name-full").textContent,YoastSEO.app.snippetPreview.unformattedText.snippet_cite=document.getElementById("editable-post-name-full").textContent,YoastSEO.app.analyzeTimer()):5e3>a&&(a+=200,setTimeout(this.bindSnippetCiteEvents.bind(this,a),200))},e.prototype.bindSlugEditor=function(){a("#titlediv").on("change","#new-post-slug",function(){YoastSEO.app.snippetPreview.unformattedText.snippet_cite=a("#new-post-slug").val(),YoastSEO.app.refresh()})},e.prototype.getData=function(){return{keyword:this.getDataFromInput("keyword"),meta:this.getDataFromInput("meta"),text:this.getDataFromInput("text"),title:this.getDataFromInput("title"),url:this.getDataFromInput("url"),excerpt:this.getDataFromInput("excerpt"),snippetTitle:this.getDataFromInput("snippetTitle"),snippetMeta:this.getDataFromInput("snippetMeta"),snippetCite:this.getDataFromInput("cite"),usedKeywords:wpseoPostScraperL10n.keyword_usage,searchUrl:'<a target="_blank" href='+wpseoPostScraperL10n.search_url+">",postUrl:'<a target="_blank" href='+wpseoPostScraperL10n.post_edit_url+">"}},e.prototype.getDataFromInput=function(b){var c,e="";switch(b){case"text":case"content":e=this.getContentTinyMCE();break;case"cite":case"url":c=a("#new-post-slug"),0<c.length?e=c.val():null!==document.getElementById("editable-post-name-full")&&(e=document.getElementById("editable-post-name-full").textContent);break;case"meta":e=document.getElementById("yoast_wpseo_metadesc")&&document.getElementById("yoast_wpseo_metadesc").value||"";break;case"snippetMeta":e=document.getElementById("yoast_wpseo_metadesc")&&document.getElementById("yoast_wpseo_metadesc").value||"";break;case"keyword":e=document.getElementById("yoast_wpseo_focuskw_text_input")&&document.getElementById("yoast_wpseo_focuskw_text_input").value||"",d=e;break;case"title":e=document.getElementById("title")&&document.getElementById("title").value||"";break;case"snippetTitle":e=document.getElementById("yoast_wpseo_title")&&document.getElementById("yoast_wpseo_title").value||"";break;case"excerpt":null!==document.getElementById("excerpt")&&(e=document.getElementById("excerpt")&&document.getElementById("excerpt").value||"")}return e},e.prototype.setDataFromSnippet=function(a,b){switch(b){case"snippet_meta":document.getElementById("yoast_wpseo_metadesc").value=a;break;case"snippet_cite":document.getElementById("post_name").value=a,null!==document.getElementById("editable-post-name")&&(document.getElementById("editable-post-name").textContent=a,document.getElementById("editable-post-name-full").textContent=a);break;case"snippet_title":document.getElementById("yoast_wpseo_title").value=a}},e.prototype.saveSnippetData=function(a){this.setDataFromSnippet(a.title,"snippet_title"),this.setDataFromSnippet(a.urlPath,"snippet_cite"),this.setDataFromSnippet(a.metaDesc,"snippet_meta")},e.prototype.getContentTinyMCE=function(){return"undefined"==typeof tinyMCE||"undefined"==typeof tinyMCE.editors||0===tinyMCE.editors.length||tinyMCE.get("content").isHidden()?this.getTinyMCEElementContent():tinyMCE.get("content").getContent()},e.prototype.getTinyMCEElementContent=function(){return document.getElementById("content")&&document.getElementById("content").value||""},e.prototype.bindElementEvents=function(a){this.inputElementEventBinder(a),document.getElementById("yoast_wpseo_focuskw_text_input").addEventListener("keydown",a.snippetPreview.disableEnter),document.getElementById("yoast_wpseo_focuskw_text_input").addEventListener("keyup",this.updateKeywordUsage)},e.prototype.inputElementEventBinder=function(a){for(var b=["excerpt","content","yoast_wpseo_focuskw_text_input","title"],c=0;c<b.length;c++){var d=document.getElementById(b[c]);null!==d&&document.getElementById(b[c]).addEventListener("input",a.analyzeTimer.bind(a))}if("undefined"!=typeof tinyMCE&&"function"==typeof tinyMCE.on){var e=["input","change","cut","paste"];tinyMCE.on("addEditor",function(b){for(var c=0;c<e.length;c++)b.editor.on(e[c],a.analyzeTimer.bind(a))})}document.getElementById("yoast_wpseo_focuskw_text_input").addEventListener("blur",this.resetQueue)},e.prototype.resetQueue=function(){""!==YoastSEO.app.rawData.keyword&&YoastSEO.app.runAnalyzer(this.rawData)},e.prototype.saveScores=function(b){var c,e;this.isMainKeyword(d)&&(document.getElementById("yoast_wpseo_linkdex").value=b,e=""===d?"na":YoastSEO.app.scoreFormatter.overallScoreRating(parseInt(b,10)),c=YoastSEO.app.scoreFormatter.getSEOScoreText(e),a(".yst-traffic-light").attr("class","yst-traffic-light "+e).attr("alt",c)),YoastSEO.multiKeyword||this.updateKeywordTabContent(d,b),jQuery(window).trigger("YoastSEO:numericScore",b)},e.prototype.isMainKeyword=function(b){var c,d;return c=a(".wpseo_keyword_tab").first().find(".wpseo_tablink"),d=c.data("keyword"),b===d},e.prototype.initKeywordTabTemplate=function(){var b,c;YoastSEO.multiKeyword||(a(".wpseo-metabox-tabs").on("click",".wpseo_tablink",function(a){a.preventDefault()}),b=a("#yoast_wpseo_focuskw").val(),c=a("#yoast_wpseo_linkdex").val(),a("#yoast_wpseo_focuskw_text_input").val(b),this.updateKeywordTabContent(b,c))},e.prototype.updateKeywordTabContent=function(b,c){var d,e;c=parseInt(c,10),("undefined"==typeof b||""===b)&&(c="na"),d=b&&b.length>0?b:"...",c=YoastSEO.ScoreFormatter.prototype.overallScoreRating(c),e=wp.template("keyword_tab")({keyword:b,placeholder:d,score:c,hideRemove:!0,prefix:wpseoPostScraperL10n.contentTab+" ",active:!0}),a("#yoast_wpseo_focuskw").val(b),a(".wpseo_keyword_tab").replaceWith(e)},e.prototype.updateKeywordUsage=function(){var a=this.value;jQuery.post(ajaxurl,{action:"get_focus_keyword_usage",post_id:jQuery("#post_ID").val(),keyword:a},function(b){b&&(wpseoPostScraperL10n.keyword_usage[a]=b,YoastSEO.app.analyzeTimer())},"json")},jQuery(document).on("ajaxComplete",function(a,c,d){var e="/admin-ajax.php";e===d.url.substr(0-e.length)&&"string"==typeof d.data&&-1!==d.data.indexOf("action=sample-permalink")&&YoastSEO.app.snippetPreview.setUrlPath(b(c))}),jQuery(document).ready(function(){var a,b=new e,d={elementTarget:["content","yoast_wpseo_focuskw_text_input","yoast_wpseo_metadesc","excerpt","editable-post-name","editable-post-name-full"],targets:{output:"wpseo-pageanalysis"},usedKeywords:wpseoPostScraperL10n.keyword_usage,searchUrl:'<a target="_blank" href='+wpseoPostScraperL10n.search_url+">",postUrl:'<a target="_blank" href='+wpseoPostScraperL10n.post_edit_url+">",callbacks:{getData:b.getData.bind(b),bindElementEvents:b.bindElementEvents.bind(b),saveScores:b.saveScores.bind(b),saveSnippetData:b.saveSnippetData.bind(b)},locale:wpseoPostScraperL10n.locale};a=wpseoPostScraperL10n.translations,"undefined"!=typeof a&&"undefined"!=typeof a.domain&&(a.domain="js-text-analysis",a.locale_data["js-text-analysis"]=a.locale_data["wordpress-seo"],delete a.locale_data["wordpress-seo"],d.translations=a),d.snippetPreview=c(b),window.YoastSEO.app=new YoastSEO.App(d),jQuery(window).trigger("YoastSEO:ready"),new YoastReplaceVarPlugin,new YoastShortcodePlugin,b.initKeywordTabTemplate(),YoastSEO.analyzerArgs=d})}(jQuery);