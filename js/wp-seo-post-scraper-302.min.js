!function(e){"use strict";var t="",n=function(){"object"==typeof CKEDITOR&&console.warn("YoastSEO currently doesn't support ckEditor. The content analysis currently only works with the HTML editor or TinyMCE."),this.prepareSlugBinding()};n.prototype.prepareSlugBinding=function(){if(null===document.getElementById("editable-post-name")){var e=this;jQuery(document).on("after-autosave.update-post-slug",function(){e.bindSnippetCiteEvents(0)})}else this.bindSlugEditor()},n.prototype.bindSnippetCiteEvents=function(e){e=e||0;var t=document.getElementById("editable-post-name"),n=document.getElementById("post_name");null!==t?(this.bindSlugEditor(),n.value=document.getElementById("editable-post-name-full").textContent,YoastSEO.app.snippetPreview.unformattedText.snippet_cite=document.getElementById("editable-post-name-full").textContent,YoastSEO.app.refresh()):5e3>e&&(e+=200,setTimeout(this.bindSnippetCiteEvents.bind(this,e),200))},n.prototype.bindSlugEditor=function(){e("#titlediv").on("change","#new-post-slug",function(){YoastSEO.app.snippetPreview.unformattedText.snippet_cite=e("#new-post-slug").val(),YoastSEO.app.refresh()})},n.prototype.getData=function(){return{keyword:this.getDataFromInput("keyword"),meta:this.getDataFromInput("meta"),text:this.getDataFromInput("text"),pageTitle:this.getDataFromInput("pageTitle"),title:this.getDataFromInput("title"),url:this.getDataFromInput("url"),baseUrl:this.getDataFromInput("baseUrl"),excerpt:this.getDataFromInput("excerpt"),snippetTitle:this.getDataFromInput("snippetTitle"),snippetMeta:this.getDataFromInput("snippetMeta"),snippetCite:this.getDataFromInput("cite"),usedKeywords:wpseoPostScraperL10n.keyword_usage,searchUrl:'<a target="_blank" href='+wpseoPostScraperL10n.search_url+">",postUrl:'<a target="_blank" href='+wpseoPostScraperL10n.post_edit_url+">"}},n.prototype.getDataFromInput=function(n){var a,o="";switch(n){case"text":case"content":o=this.getContentTinyMCE();break;case"cite":case"url":a=e("#new-post-slug"),0<a.length?o=a.val():null!==document.getElementById("editable-post-name-full")&&(o=document.getElementById("editable-post-name-full").textContent);break;case"baseUrl":o=wpseoPostScraperL10n.base_url;break;case"meta":o=document.getElementById("yoast_wpseo_metadesc").value,""===o&&(o=wpseoPostScraperL10n.metadesc_template);break;case"snippetMeta":o=document.getElementById("yoast_wpseo_metadesc").value;break;case"keyword":o=document.getElementById("yoast_wpseo_focuskw_text_input").value,t=o;break;case"title":o=document.getElementById("title").value;break;case"snippetTitle":o=document.getElementById("yoast_wpseo_title").value;break;case"pageTitle":o=document.getElementById("yoast_wpseo_title").value,""===o&&(o=wpseoPostScraperL10n.title_template),""===o&&(o="%%title%% - %%sitename%%");break;case"excerpt":null!==document.getElementById("excerpt")&&(o=document.getElementById("excerpt").value)}return o},n.prototype.setDataFromSnippet=function(e,t){switch(t){case"snippet_meta":document.getElementById("yoast_wpseo_metadesc").value=e;break;case"snippet_cite":document.getElementById("post_name").value=e,null!==document.getElementById("editable-post-name")&&(document.getElementById("editable-post-name").textContent=e,document.getElementById("editable-post-name-full").textContent=e);break;case"snippet_title":document.getElementById("yoast_wpseo_title").value=e}},n.prototype.getContentTinyMCE=function(){var e=document.getElementById("content"),t="";return null!==e&&(t=e.value),"undefined"!=typeof tinyMCE&&"undefined"!=typeof tinyMCE.editors&&0!==tinyMCE.editors.length&&tinyMCE.get("content").hidden===!1&&(t=tinyMCE.get("content").getContent()),t},n.prototype.bindElementEvents=function(e){this.snippetPreviewEventBinder(e.snippetPreview),this.inputElementEventBinder(e),document.getElementById("yoast_wpseo_focuskw_text_input").addEventListener("keydown",e.snippetPreview.disableEnter),document.getElementById("yoast_wpseo_focuskw_text_input").addEventListener("keyup",this.updateKeywordUsage)},n.prototype.snippetPreviewEventBinder=function(e){for(var t=["snippet_meta","snippet_title","snippet_cite"],n=0;n<t.length;n++)this.bindSnippetEvents(document.getElementById(t[n]),e)},n.prototype.bindSnippetEvents=function(e,t){e.addEventListener("keydown",t.disableEnter.bind(t)),e.addEventListener("input",t.textFeedback.bind(t)),e.addEventListener("focus",t.textFeedback.bind(t)),e.addEventListener("blur",t.textFeedback.bind(t)),e.addEventListener("mouseover",t.showEditIcon.bind(t)),e.addEventListener("mouseout",t.hideEditIcon.bind(t)),e.addEventListener("focus",t.hideEditIcon.bind(t)),e.addEventListener("keyup",t.hideEditIcon.bind(t)),e.addEventListener("focus",t.getUnformattedText.bind(t)),e.addEventListener("keyup",t.setUnformattedText.bind(t)),e.addEventListener("paste",t.setUnformattedText.bind(t)),e.addEventListener("cut",t.setUnformattedText.bind(t)),e.addEventListener("click",t.setFocus.bind(t)),e.className=e.className+" showIcon"},n.prototype.inputElementEventBinder=function(e){for(var t=["excerpt","content","yoast_wpseo_focuskw_text_input","title"],n=0;n<t.length;n++){var a=document.getElementById(t[n]);null!==a&&document.getElementById(t[n]).addEventListener("input",e.analyzeTimer.bind(e))}if("undefined"!=typeof tinyMCE&&"function"==typeof tinyMCE.on){var o=["input","change","cut","paste"];tinyMCE.on("addEditor",function(t){for(var n=0;n<o.length;n++)t.editor.on(o[n],e.analyzeTimer.bind(e))})}document.getElementById("yoast_wpseo_focuskw_text_input").addEventListener("blur",this.resetQueue)},n.prototype.resetQueue=function(){""!==YoastSEO.app.rawData.keyword&&YoastSEO.app.runAnalyzer(this.rawData)},n.prototype.updateSnippet=function(e){this.updateSnippetValues(e),YoastSEO.app.snippetPreview.checkTextLength(e),YoastSEO.app.refresh()},n.prototype.updateSnippetValues=function(e){var t=e.currentTarget.textContent,n=e.currentTarget.id;"undefined"!=typeof YoastSEO.app.snippetPreview.unformattedText[n]&&(e.currentTarget.textContent=YoastSEO.app.snippetPreview.unformattedText[n]),this.setDataFromSnippet(t,e.currentTarget.id)},n.prototype.saveScores=function(n){var a,o;this.isMainKeyword(t)&&(document.getElementById("yoast_wpseo_linkdex").value=n,o=""===t?"na":YoastSEO.app.scoreFormatter.overallScoreRating(parseInt(n,10)),a=YoastSEO.app.scoreFormatter.getSEOScoreText(o),e(".yst-traffic-light").attr("class","yst-traffic-light "+o).attr("alt",a)),YoastSEO.multiKeyword||this.updateKeywordTabContent(t,n),jQuery(window).trigger("YoastSEO:numericScore",n)},n.prototype.isMainKeyword=function(t){var n,a;return n=e(".wpseo_keyword_tab").first().find(".wpseo_tablink"),a=n.data("keyword"),t===a},n.prototype.initKeywordTabTemplate=function(){var t,n;YoastSEO.multiKeyword||(e(".wpseo-metabox-tabs").on("click",".wpseo_tablink",function(e){e.preventDefault()}),t=e("#yoast_wpseo_focuskw").val(),n=e("#yoast_wpseo_linkdex").val(),e("#yoast_wpseo_focuskw_text_input").val(t),this.updateKeywordTabContent(t,n))},n.prototype.updateKeywordTabContent=function(t,n){var a,o;n=parseInt(n,10),""===t&&(n="na"),a=t.length>0?t:"...",n=YoastSEO.ScoreFormatter.prototype.overallScoreRating(n),o=wp.template("keyword_tab")({keyword:t,placeholder:a,score:n,hideRemove:!0,prefix:wpseoPostScraperL10n.contentTab+" ",active:!0}),e("#yoast_wpseo_focuskw").val(t),e(".wpseo_keyword_tab").replaceWith(o)},n.prototype.updateKeywordUsage=function(){var e=this.value;jQuery.post(ajaxurl,{action:"get_focus_keyword_usage",post_id:jQuery("#post_ID").val(),keyword:e},function(t){t&&(wpseoPostScraperL10n.keyword_usage[e]=t,YoastSEO.app.refresh())},"json")},jQuery(document).on("ajaxComplete",function(e,t){null!==t.responseText.match("Permalink:")&&(YoastSEO.app.callbacks.getData(),YoastSEO.app.runAnalyzer(),YoastSEO.app.snippetPreview.reRender())}),jQuery(document).ready(function(){var e=new n;if(YoastSEO.analyzerArgs={analyzer:!0,ajax:!0,snippetPreview:!0,elementTarget:["content","yoast_wpseo_focuskw_text_input","yoast_wpseo_metadesc","excerpt","editable-post-name","editable-post-name-full"],replaceTarget:["yoast_wpseo_metadesc","excerpt","yoast_wpseo_title"],resetTarget:["snippet_meta","snippet_title","snippet_cite"],typeDelay:300,typeDelayStep:100,maxTypeDelay:1500,dynamicDelay:!0,multiKeyword:!1,targets:{output:"wpseo-pageanalysis",snippet:"wpseosnippet"},translations:wpseoPostScraperL10n.translations,queue:["wordCount","keywordDensity","subHeadings","stopwords","fleschReading","linkCount","imageCount","urlKeyword","urlLength","metaDescription","pageTitleKeyword","pageTitleLength","firstParagraph","keywordDoubles"],usedKeywords:wpseoPostScraperL10n.keyword_usage,searchUrl:'<a target="_blank" href='+wpseoPostScraperL10n.search_url+">",postUrl:'<a target="_blank" href='+wpseoPostScraperL10n.post_edit_url+">",callbacks:{getData:e.getData.bind(e),bindElementEvents:e.bindElementEvents.bind(e),updateSnippetValues:e.updateSnippet.bind(e),saveScores:e.saveScores.bind(e)}},0===wpseoPostScraperL10n.translations.length)delete YoastSEO.analyzerArgs.translations;else{var t=wpseoPostScraperL10n.translations;t.domain="js-text-analysis",t.locale_data["js-text-analysis"]=t.locale_data["wordpress-seo"],delete t.locale_data["wordpress-seo"],YoastSEO.analyzerArgs.translations=t}window.YoastSEO.app=new YoastSEO.App(YoastSEO.analyzerArgs),jQuery(window).trigger("YoastSEO:ready"),new YoastReplaceVarPlugin,new YoastShortcodePlugin,e.initKeywordTabTemplate()})}(jQuery);