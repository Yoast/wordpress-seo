YoastSEO_WordPressScraper=function(a,b){"use strict";this.config=a,this.refObj=b,this.analyzerData={},this.formattedData={},this.formattedData.usedKeywords=wpseoMetaboxL10n.keyword_usage,this.formattedData.searchUrl='<a target="new" href='+wpseoMetaboxL10n.search_url+">",this.formattedData.postUrl='<a target="new" href='+wpseoMetaboxL10n.post_edit_url+">",this.formattedData.queue=["wordCount","keywordDensity","subHeadings","stopwords","fleschReading","linkCount","imageCount","urlKeyword","urlLength","metaDescription","pageTitleKeyword","pageTitleLength","firstParagraph","keywordDoubles"],this.replacedVars={},this.getData()},YoastSEO_WordPressScraper.prototype.getData=function(){"use strict";this.analyzerData.keyword=this.getDataFromInput("keyword"),this.analyzerData.meta=this.getDataFromInput("meta"),this.analyzerData.text=this.getDataFromInput("text"),this.analyzerData.pageTitle=this.getDataFromInput("pageTitle"),this.analyzerData.title=this.getDataFromInput("title"),this.analyzerData.url=this.getDataFromInput("url"),this.analyzerData.excerpt=this.getDataFromInput("excerpt"),this.analyzerData.snippetTitle=this.getDataFromInput("snippetTitle"),this.analyzerData.snippetMeta=this.getDataFromInput("meta"),this.analyzerData.snippetCite=this.getDataFromInput("cite")},YoastSEO_WordPressScraper.prototype.getDataFromInput=function(a){"use strict";var b="";switch(a){case"text":case"content":b=this.getContentTinyMCE();break;case"url":null!==document.getElementById("sample-permalink")&&(b=document.getElementById("sample-permalink").innerHTML.split("<span")[0]);break;case"cite":case"editable-post-name":if(null!==document.getElementById("editable-post-name")){b=document.getElementById("editable-post-name").textContent;var c=document.getElementById("new-post-slug");null!==c&&""===b&&(b=document.getElementById("new-post-slug").value)}break;case"meta":b=document.getElementById("yoast_wpseo_metadesc").value;break;case"keyword":b=document.getElementById("yoast_wpseo_focuskw").value;break;case"title":case"snippetTitle":b=document.getElementById("yoast_wpseo_title").value;break;case"pageTitle":b=document.getElementById("title").value;break;case"excerpt":b=document.getElementById("excerpt").value}return b},YoastSEO_WordPressScraper.prototype.setDataFromSnippet=function(a,b){"use strict";switch(b){case"snippet_meta":document.getElementById("yoast_wpseo_metadesc").value=a;break;case"snippet_cite":null!==document.getElementById("editable-post-name")&&(document.getElementById("editable-post-name").textContent=a,document.getElementById("editable-post-name-full").textContent=a);break;case"snippet_title":document.getElementById("yoast_wpseo_title").value=a}},YoastSEO_WordPressScraper.prototype.getAnalyzerInput=function(){"use strict";this.analyzerDataQueue=["text","keyword","meta","url","title","pageTitle","snippetTitle","snippetMeta","snippetCite","excerpt"],this.runDataQueue()},YoastSEO_WordPressScraper.prototype.runDataQueue=function(){"use strict";if(this.analyzerDataQueue.length>0){var a=this.analyzerDataQueue.shift();this.replaceVariables(this.analyzerData[a],a,this.formattedData)}else"undefined"==typeof this.refObj.snippetPreview?this.refObj.init():this.refObj.reloadSnippetText(),this.refObj.runAnalyzerCallback()},YoastSEO_WordPressScraper.prototype.getContentTinyMCE=function(){"use strict";var a=document.getElementById("content").value;return 0!==tinyMCE.editors.length&&(a=tinyMCE.get("content").getContent()),a},YoastSEO_WordPressScraper.prototype.getInputFieldsData=function(a){"use strict";var b=a.currentTarget.id.replace(/snippet_/i,"");switch(b){case"title":document.getElementById("snippet_title").textContent=document.getElementById("yoast_wpseo_title").value,document.getElementById("snippet_title").focus();break;case"meta":document.getElementById("snippet_meta").focus(),document.getElementById("snippet_meta").textContent=document.getElementById("yoast_wpseo_metadesc").value;break;case"url":var c=document.getElementById("snippet_cite").textContent;document.getElementById("editable-post-name").textContent=c,document.getElementById("editable-post-name").focus()}},YoastSEO_WordPressScraper.prototype.replaceVariables=function(a,b,c){"use strict";if("undefined"==typeof a)c[b]="",this.runDataQueue();else if(a=this.titleReplace(a),a=this.defaultReplace(a),a=this.parentReplace(a),a=this.doubleSepReplace(a),a=this.excerptReplace(a),-1!==a.indexOf("%%")&&null!==a.match(/%%[a-z0-9_-]+%%/i)&&"undefined"!=typeof this.replacedVars){for(var d=/%%[a-z0-9_-]+%%/gi,e=a.match(d),f=0;f<e.length;f++)if("undefined"!=typeof this.replacedVars[e[f]])a=a.replace(e[f],this.replacedVars[e[f]]);else{var g=e[f];this.replacedVars[g]="";var h={};h.replaceableVar=g,h.textString=a,h.type=b,h.object=c,this.ajaxReplaceVariables(h)}null===a.match(/%%[a-z0-9_-]+%%/i)&&(c[b]=a,this.runDataQueue())}else c[b]=a,this.runDataQueue()},YoastSEO_WordPressScraper.prototype.titleReplace=function(a){"use strict";var b=this.analyzerData.title;return"undefined"==typeof b&&(b=this.analyzerData.pageTitle),b.length>0&&(a=a.replace(/%%title%%/g,b)),a},YoastSEO_WordPressScraper.prototype.parentReplace=function(a){"use strict";var b=document.getElementById("parent_id");return null!==b&&b.options[b.selectedIndex].text!==wpseoMetaboxL10n.no_parent_text&&(a=a.replace(/%%parent_title%%/,b.options[b.selectedIndex].text)),a},YoastSEO_WordPressScraper.prototype.doubleSepReplace=function(a){"use strict";var b=this.refObj.stringHelper.addEscapeChars(wpseoMetaboxL10n.sep),c=new RegExp(b+" "+b,"g");return a=a.replace(c,wpseoMetaboxL10n.sep)},YoastSEO_WordPressScraper.prototype.excerptReplace=function(a){"use strict";return this.analyzerData.excerpt.length>0&&(a.replace(/%%excerpt_only%%/,this.analyzerData.excerpt),a.replace(/%%excerpt%%/,this.analyzerData.excerpt)),a},YoastSEO_WordPressScraper.prototype.defaultReplace=function(a){"use strict";return a.replace(/%%sitedesc%%/g,wpseoMetaboxL10n.sitedesc).replace(/%%sitename%%/g,wpseoMetaboxL10n.sitename).replace(/%%sep%%/g,wpseoMetaboxL10n.sep).replace(/%%date%%/g,wpseoMetaboxL10n.date).replace(/%%id%%/g,wpseoMetaboxL10n.id).replace(/%%page%%/g,wpseoMetaboxL10n.page).replace(/%%currenttime%%/g,wpseoMetaboxL10n.currenttime).replace(/%%currentdate%%/g,wpseoMetaboxL10n.currentdate).replace(/%%currentday%%/g,wpseoMetaboxL10n.currentday).replace(/%%currentmonth%%/g,wpseoMetaboxL10n.currentmonth).replace(/%%currentyear%%/g,wpseoMetaboxL10n.currentyear).replace(/%%focuskw%%/g,this.refObj.stringHelper.stripAllTags(this.analyzerData.keyword))},YoastSEO_WordPressScraper.prototype.ajaxReplaceVariables=function(a){"use strict";jQuery.post(ajaxurl,{action:"wpseo_replace_vars",string:a.replaceableVar,post_id:jQuery("#post_ID").val(),_wpnonce:wpseoMetaboxL10n.wpseo_replace_vars_nonce},function(b){b&&(YoastSEO_loader.source.replacedVars[a.replaceableVar]=b,YoastSEO_loader.source.replaceVariables(a.textString,a.type,a.object))})},YoastSEO_WordPressScraper.prototype.bindElementEvents=function(){"use strict";this.snippetPreviewEventBinder(),this.inputElementEventBinder(),document.getElementById("yoast_wpseo_focuskw").addEventListener("keydown",this.refObj.snippetPreview.disableEnter)},YoastSEO_WordPressScraper.prototype.snippetPreviewEventBinder=function(){"use strict";for(var a=["snippet_cite","snippet_meta","snippet_title"],b=0;b<a.length;b++)document.getElementById(a[b]).addEventListener("focus",this.getInputFieldsData),document.getElementById(a[b]).addEventListener("keydown",this.refObj.snippetPreview.disableEnter),document.getElementById(a[b]).addEventListener("blur",this.refObj.snippetPreview.checkTextLength),document.getElementById(a[b]).addEventListener("input",this.refObj.snippetPreview.textFeedback),document.getElementById(a[b]).addEventListener("focus",this.refObj.snippetPreview.textFeedback),document.getElementById(a[b]).addEventListener("mouseover",this.refObj.snippetPreview.showEditIcon),document.getElementById(a[b]).addEventListener("mouseout",this.refObj.snippetPreview.hideEditIcon),document.getElementById(a[b]).addEventListener("focus",this.refObj.snippetPreview.hideEditIcon),document.getElementById(a[b]).addEventListener("keyup",this.refObj.snippetPreview.hideEditIcon);for(a=["title_container","url_container","meta_container"],b=0;b<a.length;b++)document.getElementById(a[b]).addEventListener("click",this.refObj.snippetPreview.setFocus)},YoastSEO_WordPressScraper.prototype.inputElementEventBinder=function(){"use strict";for(var a=["excerpt","content","editable-post-name","yoast_wpseo_focuskw"],b=0;b<a.length;b++){var c=document.getElementById(a[b]);null!==c&&document.getElementById(a[b]).addEventListener("change",this.renewData)}},YoastSEO_WordPressScraper.prototype.renewData=function(a){"use strict";a.currentTarget.__refObj.source.getData(),a.currentTarget.__refObj.source.getAnalyzerInput()},YoastSEO_WordPressScraper.prototype.updateSnippetValues=function(a){"use strict";var b=a.currentTarget.textContent;"undefined"!=typeof a.currentTarget.__unformattedText&&""!==a.currentTarget.__unformattedText&&(b=a.currentTarget.__unformattedText,a.currentTarget.__unformattedText=""),a.currentTarget.refObj.source.setDataFromSnippet(b,a.currentTarget.id),a.currentTarget.refObj.source.getData(),a.currentTarget.refObj.source.getAnalyzerInput()},YoastSEO_WordPressScraper.prototype.saveScores=function(a){"use strict";document.getElementById(this.config.targets.overall).textContent=a,document.getElementById("yoast_wpseo_linkdex").value=a},jQuery(document).on("ajaxComplete",function(a,b){"use strict";null!==b.responseText.match("Permalink:")&&(YoastSEO_loader.source.getData(),YoastSEO_loader.source.getAnalyzerInput(),YoastSEO_loader.snippetPreview.reRender())});