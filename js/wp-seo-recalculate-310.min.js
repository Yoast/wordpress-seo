!function(a){"use strict";function b(a){var b=parseInt(a.posts,10),c=parseInt(a.terms,10),d=new e(b+c);d.start(b,"post","post_id",function(){d.start(c,"term","term_id",!1)})}function c(){var c=jQuery("#wpseo_recalculate_link");void 0!==c&&(c.click(function(){jQuery("#wpseo_count").text(0),a.post(ajaxurl,{action:"wpseo_recalculate_total",nonce:jQuery("#wpseo_recalculate_nonce").val()},b,"json")}),c.data("open")&&c.trigger("click"))}var d=new YoastSEO.Jed({domain:"js-text-analysis",locale_data:{"js-text-analysis":{"":{}}}}),e=function(b){this.total_count=b,this.oncomplete=!1,a("#wpseo_count_total").html(b),jQuery("#wpseo_progressbar").progressbar({value:0})};e.prototype.start=function(a,b,c,d){this.fetch_type=b,this.items_to_fetch=a,this.id_field=c,this.oncomplete=d,this.getItemsToRecalculate(1)},e.prototype.updateProgressBar=function(a){var b=jQuery("#wpseo_count").text(),c=parseInt(b,10)+a,d=c*(100/this.total_count);jQuery("#wpseo_progressbar").progressbar("value",d),this.updateCountElement(c)},e.prototype.updateCountElement=function(a){jQuery("#wpseo_count").html(a)},e.prototype.calculateScores=function(a,b){for(var c=[],d=0;a>d;d++)c.push(this.getScore(b[d]));return c},e.prototype.getScore=function(a){return{item_id:this.getItemID(a),taxonomy:a.taxonomy?a.taxonomy:"",score:this.calculateItemScore(a)}},e.prototype.getItemID=function(a){return this.items_to_fetch--,a[this.id_field]},e.prototype.calculateItemScore=function(a){a.i18n=d,a.locale=wpseoAdminL10n.locale;var b=new YoastSEO.Analyzer(a);return b.runQueue(),b.analyzeScorer.__totalScore},e.prototype.parseResponse=function(a){if(""!==a&&null!==a){if(void 0!==a.total_items){var b=this.calculateScores(a.total_items,a.items);this.sendScores(b),this.updateProgressBar(a.total_items)}return void 0!==a.next_page?this.getItemsToRecalculate(a.next_page):this.onCompleteRequest(),!0}this.onCompleteRequest()},e.prototype.onCompleteRequest=function(){this.oncomplete!==!1&&(this.oncomplete(),this.oncomplete=!1)},e.prototype.sendScores=function(a){jQuery.post(ajaxurl,{action:"wpseo_update_score",nonce:jQuery("#wpseo_recalculate_nonce").val(),scores:a,type:this.fetch_type})},e.prototype.getItemsToRecalculate=function(a){jQuery.post(ajaxurl,{action:"wpseo_recalculate_scores",nonce:jQuery("#wpseo_recalculate_nonce").val(),paged:a,type:this.fetch_type},this.parseResponse.bind(this),"json")},a(c)}(jQuery);